<!DOCTYPE html>
<!-- saved from url=(0037)https://db-dashboard-s6ln.vercel.app/ -->
<html lang="ko"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>DB Pro Master v24.22 (Final)</title>
    <link href="./DB Pro Master v24.22 (Final)_files/all.min.css" rel="stylesheet">
    <script src="./DB Pro Master v24.22 (Final)_files/xlsx.full.min.js.다운로드"></script>
    <style>
        :root { 
            --primary: #2563eb; 
            --primary-dark: #1e40af; 
            --bg-light: #f1f5f9; 
            --border: #e2e8f0; 
            --text: #334155; 
            --danger: #ef4444; 
            --success: #10b981; 
            --prospect: #8b5cf6; 
            --warning: #f59e0b;
        }
        * { box-sizing: border-box; outline: none; }
        body { font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, system-ui, Roboto, sans-serif; margin: 0; background: var(--bg-light); color: var(--text); height: 100vh; display: flex; overflow: hidden; }
        ::-webkit-scrollbar { width: 6px; height: 6px; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 3px; }
        
        .btn { padding: 10px 16px; border-radius: 8px; border: none; font-weight: 600; cursor: pointer; font-size: 14px; transition: all 0.2s ease; display: inline-flex; align-items: center; gap: 6px; justify-content: center; }
        .btn:hover { transform: translateY(-1px); box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        .btn:active { transform: translateY(0); }
        .btn-primary { background: var(--primary); color: white; }
        .btn-primary:hover { background: var(--primary-dark); }
        .btn-danger { background: #fee2e2; color: var(--danger); }
        .btn-danger:hover { background: #fecaca; }
        .btn-dark { background: #1e293b; color: white; }
        .btn-secondary { background: white; border: 1px solid #cbd5e1; color: #64748b; }
        .btn-success { background: var(--success); color: white; }
        .btn-warning { background: var(--warning); color: white; }

        input, select, textarea { font-family: inherit; }
        input[type=number]::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }
        input[type="date"] { cursor: pointer; position: relative; }

        .form-group input:focus, .form-group select:focus, .form-group textarea:focus { 
            border-color: var(--primary); 
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1); 
        }

        #hist-input { padding: 10px 12px; border: 1px solid #cbd5e1; border-radius: 8px; font-size: 14px; transition: 0.2s; }
        #hist-input:focus { border-color: var(--primary); box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1); }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        #login-screen { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%); z-index: 9999; display: flex; justify-content: center; align-items: center; }
        .login-box { background: white; padding: 40px; border-radius: 24px; width: 400px; text-align: center; box-shadow: 0 25px 50px -12px rgba(0,0,0,0.25); }
        .login-input { width: 100%; padding: 14px; border: 2px solid #e2e8f0; border-radius: 12px; margin-bottom: 15px; font-size: 16px; transition: 0.2s; }
        .login-input:focus { border-color: var(--primary); }

        #loading-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.4); z-index: 10000; display: none; justify-content: center; align-items: center; backdrop-filter: blur(2px); }
        .spinner { width: 40px; height: 40px; border: 4px solid #f3f3f3; border-top: 4px solid var(--primary); border-radius: 50%; animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        
        #toast-container { position: fixed; top: 20px; right: 20px; z-index: 10001; display: flex; flex-direction: column; gap: 10px; pointer-events: none; }
        .toast { background: white; padding: 16px 20px; border-radius: 12px; box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1); display: flex; align-items: center; gap: 10px; font-weight: 600; font-size: 14px; animation: slideInRight 0.3s forwards; pointer-events: auto; border-left: 5px solid var(--primary); min-width: 300px; }
        .toast.success { border-left-color: var(--success); }
        .toast.error { border-left-color: var(--danger); }
        .toast.warning { border-left-color: var(--warning); }
        @keyframes slideInRight { from { transform: translateX(100%); opacity: 0; } to { transform: translateX(0); opacity: 1; } }
        @keyframes fadeOut { to { opacity: 0; transform: translateY(-10px); } }

        .sidebar { width: 260px; background: white; border-right: 1px solid var(--border); padding: 24px; display: flex; flex-direction: column; z-index: 50; transition: 0.3s; }
        .sidebar.admin-mode { background: linear-gradient(160deg, #0f172a 0%, #1e293b 100%); color: white; border: none; }
        .logo-area { font-size: 20px; font-weight: 900; color: var(--primary); margin-bottom: 30px; display: flex; align-items: center; gap: 10px; letter-spacing: -0.5px; }
        .sidebar.admin-mode .logo-area { color: white; }
        
        .btn-big-action { width: 100%; padding: 14px; border-radius: 12px; border: none; font-size: 15px; font-weight: 700; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 8px; margin-bottom: 10px; transition: 0.2s; box-shadow: 0 1px 2px rgba(0,0,0,0.05); }
        .btn-new-db { background: var(--primary); color: white; }
        .btn-new-db:hover { background: var(--primary-dark); }
        
        .nav-item { padding: 12px 14px; margin-bottom: 6px; border-radius: 10px; cursor: pointer; color: #64748b; font-weight: 600; display: flex; align-items: center; gap: 10px; transition: 0.2s; font-size: 14px; }
        .nav-item:hover, .nav-item.active { background: #eff6ff; color: var(--primary); }
        .sidebar.admin-mode .nav-item { color: #94a3b8; }
        .sidebar.admin-mode .nav-item:hover, .sidebar.admin-mode .nav-item.active { background: rgba(255,255,255,0.1); color: white; }
        
        .sidebar.admin-mode .profile-box { background: rgba(255,255,255,0.1) !important; border-color: rgba(255,255,255,0.2) !important; }
        .sidebar.admin-mode #profile-name { color: white !important; }
        .sidebar.admin-mode #profile-role { color: #cbd5e1 !important; }

        .main-content { flex: 1; display: flex; flex-direction: column; overflow: hidden; position: relative; }
        .header { height: 64px; background: white; border-bottom: 1px solid var(--border); display: flex; align-items: center; justify-content: space-between; padding: 0 30px; }
        .page-content { flex: 1; overflow-y: auto; padding: 30px; }
        .card { background: white; border-radius: 16px; padding: 24px; border: 1px solid var(--border); margin-bottom: 20px; box-shadow: 0 1px 3px rgba(0,0,0,0.02); }
        
        .table-container { overflow-x: auto; background: white; border-radius: 12px; border: 1px solid var(--border); }
        table { width: 100%; border-collapse: collapse; font-size: 13px; white-space: nowrap; }
        th { background: #f8fafc; padding: 12px 16px; text-align: center; color: #64748b; font-weight: 700; border-bottom: 1px solid var(--border); font-size: 12px; text-transform: uppercase; }
        td { padding: 14px 16px; border-bottom: 1px solid var(--border); color: #333; text-align: center; font-weight: 500; }
        tr:hover { background-color: #f8fafc; cursor: pointer; }
        .badge { padding: 4px 8px; border-radius: 6px; font-size: 11px; font-weight: 700; }
        .status-wait { background: #f1f5f9; color: #64748b; }
        .status-ing { background: #dbeafe; color: #2563eb; }
        .status-prospect { background: #f3e8ff; color: #7c3aed; }
        .status-done { background: #dcfce7; color: #16a34a; }
        .status-end { background: #fee2e2; color: #dc2626; }
        .status-share { background: #ffedd5; color: #c2410c; }

        .dashboard-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 20px; margin-bottom: 30px; }
        .stat-card { background: white; padding: 24px; border-radius: 16px; display: flex; flex-direction: column; justify-content: space-between; border-left: 5px solid var(--primary); box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05); }
        .stat-label { font-size: 13px; color: #64748b; font-weight: 700; margin-bottom: 8px; }
        .stat-value { font-size: 24px; font-weight: 800; color: #1e293b; }
        .rank-card { flex:1; background:white; border-radius:12px; padding:20px; border:1px solid #e2e8f0; }
        .rank-title { font-weight:800; font-size:15px; margin-bottom:15px; display:flex; align-items:center; gap:8px; }
        .rank-list { list-style:none; padding:0; margin:0; }
        .rank-item { display:flex; justify-content:space-between; padding:10px 0; border-bottom:1px solid #f1f5f9; font-size:14px; }
        .rank-val { font-weight:bold; color:var(--primary); }
        
        .progress-bar-bg { background: #e2e8f0; height: 8px; border-radius: 4px; overflow: hidden; width: 100px; margin: 5px auto 0; }
        .progress-bar-fill { height: 100%; background: var(--primary); border-radius: 4px; transition: width 0.3s ease; }

        .compare-row { display: flex; gap: 20px; margin-bottom: 20px; }
        .compare-box { flex: 1; background: #f8fafc; padding: 20px; border-radius: 12px; text-align: center; border: 1px solid #e2e8f0; }
        .compare-val { font-size: 24px; font-weight: 800; }

        .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); display: none; justify-content: center; align-items: center; z-index: 100; backdrop-filter: blur(2px); }
        .modal-window { background: white; width: 1200px; height: 95vh; border-radius: 20px; display: flex; flex-direction: column; overflow: hidden; box-shadow: 0 25px 50px -12px rgba(0,0,0,0.25); }
        .modal-header { padding: 20px 30px; border-bottom: 1px solid var(--border); display: flex; justify-content: space-between; align-items: center; background: #fff; }
        
        .modal-body { flex: 1; display: flex; overflow: hidden; background: #f8fafc; }
        .panel-left { flex: 7; padding: 30px; overflow-y: auto; border-right: 1px solid var(--border); }
        .panel-right { flex: 3; padding: 30px; display: flex; flex-direction: column; background: white; }
        
        .form-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px; margin-bottom: 24px; }
        .form-group label { display: block; font-size: 12px; font-weight: 700; color: #64748b; margin-bottom: 6px; }
        .form-group input, .form-group select, .form-group textarea { width: 100%; padding: 10px 12px; border: 1px solid #cbd5e1; border-radius: 8px; font-size: 14px; transition: 0.2s; }
        
        .dynamic-section { display: none; background: white; border: 1px solid var(--border); padding: 20px; border-radius: 12px; margin-top: 15px; }
        .dynamic-section.active { display: block; animation: fadeIn 0.3s; }
        .contract-box { background: #ecfdf5; border-color: #6ee7b7; }
        .prospect-box { background: #f3e8ff; border-color: #d8b4fe; }
        
        .share-info { background: #fffbeb; border: 1px solid #fcd34d; padding: 15px; border-radius: 8px; margin-top: 15px; }
        .share-row { display: flex; align-items: center; gap: 8px; margin-bottom: 8px; }
        .share-row select { flex: 2; padding: 8px; border: 1px solid #cbd5e1; border-radius: 6px; }
        .share-row input { width: 70px; padding: 8px; border: 1px solid #cbd5e1; border-radius: 6px; text-align: right; }
        .share-val { min-width: 80px; text-align: right; font-weight: bold; color: var(--primary); }

        .meeting-badge { display: inline-flex; align-items: center; gap: 4px; padding: 6px 12px; border-radius: 20px; font-size: 12px; font-weight: 700; cursor: pointer; }
        .meeting-today { background: #fef3c7; color: #d97706; animation: pulse 2s infinite; }
        .meeting-upcoming { background: #dbeafe; color: #2563eb; }
        .meeting-overdue { background: #fee2e2; color: #dc2626; }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.7; } }

        /* 로드맵 */
        #roadmap-modal .modal-window { width: 1400px; height: 95vh; }
        #roadmap-modal .modal-body { display: block; padding: 30px; overflow-y: auto; }
        .roadmap-toolbar { background: #f8fafc; padding: 20px; border-radius: 12px; margin-bottom: 25px; border: 1px solid #e2e8f0; }
        .roadmap-presets { display: flex; gap: 8px; flex-wrap: wrap; margin-bottom: 20px; }
        .btn-preset { padding: 8px 14px; font-size: 13px; background: white; color: #475569; border: 1px solid #cbd5e1; border-radius: 20px; cursor: pointer; font-weight: 600; }
        .btn-preset.active { background: #eff6ff; color: var(--primary); border-color: var(--primary); }
        .rm-input-row { display: flex; gap: 10px; align-items: center; background: white; padding: 15px; border-radius: 10px; border: 1px solid #e2e8f0; }
        .rm-input-row.edit-mode { border: 2px solid var(--primary); background: #eff6ff; }
        .rm-input-group { display: flex; flex-direction: column; gap: 5px; }
        .rm-container { border: 2px solid #334155; padding: 30px; border-radius: 15px; margin-bottom: 20px; background: white; overflow-x: auto; }
        .rm-table { width: 100%; border-collapse: collapse; table-layout: fixed; font-size: 12px; }
        .rm-header { background: #1e3a8a; color: white; padding: 12px 0; border: 1px solid #94a3b8; font-weight:bold; text-align:center; }
        .rm-subheader { background: #3b82f6; color: white; padding: 6px 0; border: 1px solid #94a3b8; font-size:11px; text-align:center; }
        .rm-cell { border: 1px solid #cbd5e1; height: 55px; position: relative; background: white; }
        .rm-cat-col { width: 120px; text-align: center; font-weight: 800; border: 1px solid #94a3b8; color: white; padding: 5px; word-break: keep-all; vertical-align: middle; }
        .rm-diagonal { background: linear-gradient(to top right, #f1f5f9 49.5%, #94a3b8 50%, #f1f5f9 50.5%); position: relative; }
        .rm-diagonal-text { position: absolute; font-size: 11px; font-weight: bold; color: #334155; }
        .rm-text-bottom-left { bottom: 5px; left: 8px; }
        .rm-text-top-right { top: 5px; right: 8px; }
        .rm-bar-container { position: absolute; top: 10px; bottom: 10px; border-radius: 15px; display: flex; align-items: center; color: white; font-size: 12px; font-weight: bold; box-shadow: 2px 3px 6px rgba(0,0,0,0.15); overflow: hidden; z-index: 10; cursor: pointer; white-space: nowrap; }
        .rm-align-left { justify-content: flex-start; padding-left: 10px; }
        .rm-align-center { justify-content: center; }
        .rm-align-right { justify-content: flex-end; padding-right: 10px; }
        .rm-bar-outer-text { position: absolute; top: 50%; transform: translateY(-50%); left: 105%; margin-left: 8px; font-size: 11px; font-weight: bold; color: #334155; z-index: 5; white-space: nowrap; }
        .rm-item-chip { display:inline-flex; background:#f1f5f9; padding:6px 12px; margin:3px; border-radius:20px; border:1px solid #cbd5e1; font-size:13px; cursor:grab; align-items:center; }
        .rm-item-chip.drag-over { border-left: 3px solid var(--primary); background: #eff6ff; }
        .rm-title-edit { font-size: 32px; font-weight: 900; text-align: center; margin-bottom: 40px; border: 2px dashed transparent; display: block; font-family:'Pretendard'; color:#1e293b; outline:none; }
        .rm-title-edit:hover { border-color: #cbd5e1; background: #f8fafc; }
        .bg-grad-0 { background: #0f172a; } .bg-grad-1 { background: #1e3a8a; } .bg-grad-2 { background: #1d4ed8; } .bg-grad-3 { background: #3b82f6; } .bg-grad-4 { background: #60a5fa; } .bg-grad-5 { background: #93c5fd; color:#1e293b!important; }

        /* 팀원 관리 모달 */
        #member-modal .modal-window { width: 600px; height: auto; max-height: 80vh; }
        #member-modal .modal-body { display: block; padding: 20px; overflow-y: auto; }
        .member-list-item { display: flex; justify-content: space-between; align-items: center; padding: 12px 15px; border-bottom: 1px solid #e2e8f0; }
        .member-list-item:hover { background: #f8fafc; }
        .member-name { font-weight: 600; color: #1e293b; }
        .member-role { font-size: 12px; color: #64748b; margin-left: 8px; }
        .member-actions { display: flex; gap: 8px; }
        .btn-icon { width: 32px; height: 32px; border-radius: 8px; border: none; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: 0.2s; }
        .btn-icon-danger { background: #fee2e2; color: #dc2626; }
        .btn-icon-danger:hover { background: #fecaca; }
        .add-member-row { display: flex; gap: 10px; padding: 15px; background: #f8fafc; border-radius: 8px; margin-top: 15px; }
        .add-member-row input { flex: 1; padding: 10px; border: 1px solid #cbd5e1; border-radius: 8px; }

        @media print {
            body * { visibility: hidden; }
            #roadmap-print-area, #roadmap-print-area * { visibility: visible; }
            #roadmap-print-area { position: absolute; left: 0; top: 0; width: 100%; }
            .rm-container { border: none !important; padding: 0 !important; }
            * { -webkit-print-color-adjust: exact !important; print-color-adjust: exact !important; }
        }

        @media (max-width: 768px) {
            body { flex-direction: column; overflow: auto; }
            .sidebar { position: fixed; top: 0; left: 0; height: 100%; transform: translateX(-100%); width: 280px; box-shadow: none; }
            .sidebar.active { transform: translateX(0); box-shadow: 100px 0 0 rgba(0,0,0,0.5); }
            .main-content { width: 100%; height: auto; overflow: visible; }
            .page-content { padding: 15px; overflow: visible; padding-bottom: 80px; }
            .header { padding: 0 15px; }
            #mobile-menu-btn { display: block !important; font-size: 24px; cursor: pointer; color: #334155; }
            .login-box { width: 90%; padding: 25px; }
            .dashboard-grid, .form-grid { grid-template-columns: 1fr; gap: 10px; }
            .compare-row, #list-filter-container { flex-direction: column; }
            
            .modal-window { width: 100% !important; height: 100% !important; border-radius: 0; top: 0; left: 0; }
            .modal-body { flex-direction: column; overflow-y: auto; padding: 0; }
            .panel-left, .panel-right { width: 100%; padding: 15px; border: none; flex: none; overflow-y: visible; max-height: none; }
            .panel-right { border-top: 4px solid #f1f5f9; padding-top: 20px; margin-top: 0; padding-bottom: 100px; }
            
            .rm-input-row { flex-direction: column; align-items: stretch; }
            #roadmap-modal .modal-window { width: 100% !important; height: 100% !important; }
            #roadmap-modal .modal-body { padding: 15px; padding-bottom: 100px; }
        }
    </style>
<style type="text/css">#screenShotContainer{cursor:crosshair;left:0;position:absolute;top:0}#toolPanel{background:#fff;border-radius:6px;box-sizing:content-box;height:24px;left:0;min-width:392px;padding:6px 14px;position:absolute;top:0;z-index:9999}#toolPanel .item-panel{float:left;height:24px;margin-right:15px;width:24px}#toolPanel .item-panel:last-child{margin-right:0}#toolPanel .square{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAACXBIWXMAACE4AAAhOAFFljFgAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAHfSURBVHgB7ZpNboJAFMffY2hK/EhYWl3U3sSeQG/gEeoNxBvYI/QGeoLak9SVdSeNxlKFeR2atPEjDGiaCNP3S1jAvCHzG4ZhwR+AYRiGyS8I5+DUmnBpnMAH3/fhRLILO7WWEFZXdekAkAu5AJUwjaJIDiCYTzP1yFJklep9RPAgxxCBJ9ezQVqdSCsogmyMGmMLr6pA2+WLtk7XGL+rahm/QoFAlPfhaj5Jard1nZVs//iG9GiHNIQLEwnhElJHLeW9MRLF+wxM4BxEubEQ5Tr9HHal7kHOsCuN4e4Y1bHQ1VuJLW7TPdyNw8/tCHJGGEaHq80F5+Y2qT5ZOAiOPz3C1s5eEbDgn8HCpsPCpsPCpsPCpsPCpsPCpsPCpsPCpsPCpsPCpsPCpsPCpsPCpsPCpsPCplN8YSGO/2M7H+9J5Zof4nHuCfeCX7aAHuQMi6h9cEkbWNOGWojkGBG7v+eAPatU9+V2O1Yze3IK7q+xhHhAoMOHoI1laGNLdqXWIrKeoUBEkbzTpfK0wTS5WU3FdTWelBYUAEQYyPWb9gmnJvHkZjkpgnQsG65mXmodZOU7lYeeeo/bGEeDcgCpDUqNZYQon3Tpu13Oiw+7rusEzsWlg4wJWoZhGKYofAHzGYh5VvrALQAAAABJRU5ErkJggg==");background-size:cover}#toolPanel .square-active,#toolPanel .square:active,#toolPanel .square:hover{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAACXBIWXMAACE4AAAhOAFFljFgAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAGzSURBVHgB7ZpBSsNAFIb/GYq6zA3Um+gJ9Abisoi0nqDJCVSKdCOIN2hPYI/gDfQGVtyUQjO+qRaaNDOZFqGT5/sWhWTmlfmGycsiPyAIgiDEi8I2DMwRds0UE9yoCTYkXLhvTtDCBeY4p6oEMWBIWmGIGTKSfw8pCRN+MD36TREzmtbXVlndtHrhJsguCZD2C9/Ss7qHNzSJHKe4VmPXcMtXS7K9irv3tJN32DU59ZGc+okurVFTnwHGrjK/MOgPi2S4Uini4ZWaaUKSnZV7ds2XrgLtGqDjbDtxuRsPERuttdOW4NEcuqa7hQ8qXj37+EDD0fhniDB3RJg7IswdEeaOCHNHhLkjwtwRYe6IMHdEmDsizB0R5o4Ic0eEuSPC3Gm+cF7xHfsLn67pbuH2IvdUDH7N0EV8nJWuvYE1f8bDYAS1CIksr7sYmAnt6oi2auMU3J9j0FmsqYg3luGPLdn0ncYLmoTG8e/pdAz7sHmnHLXptojIfLKWsOhh36Rreaj4CIpUhYdLbYJ2jpQqbJOII1z601SHdAqffem7VbaLDz+ZBNMIpNthCVpBEAShKXwDKrBaATx5xUUAAAAASUVORK5CYII=")}#toolPanel .round{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAACXBIWXMAACE4AAAhOAFFljFgAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAVoSURBVHgB7Zq9UiNHEMd7ZiWBETbrq3IVB8neG4jM2UHmzFzo6LgnAEcOBU9geIITkS9DhI4QT2De4NaBT1Q5sKhDcMdqpt2zaxntaPZL2pWWK/0iGM3s6q/u+epugAULFix4QjCYBdXvGlCzGhy5wxmuITA7eDn2JLIbCXgF3sAF7+8rKJhiBNu2zT9/tcc4/AjAGwBopx+MHRpzKoTowKdrF3ImX8HL69uWxZr02G3IA8S2kHhCwjuQE/kIzlvoGNgRAt/kYfHpBCvX9epNmosHSV0R0WUMXHql+9gINjC0aU436Iskuj2953jQ7/4MUzC54OV1x+L8gp7gmD5GgB49vA0gL0X1Uxt6vV7i8yzYDryEvY7p6Qohdya19mSCfRe2zkyLkRLKGZwMKnfHiSKjn++LR2RNxphj6NFjTL4a3Gaf25kFW/VN+vWxZXwYg6OphBqorG4cIkLT/KncE/3rU8hANsG+ZcmNNRDQlcBfQf+vYvZRsjjn7MJkbbL0ThZL87QdAzdTbqyDp7J6v1WYWAXNV1lb2qJftj32duRn6rtBSlJb2FrZeD++QOGp6Hf3YIZY9ectw6LmiurdVpqpZEEKeH3zV5qfP4Qa6dcWd92fYMagd9vmtdUXJLox0mxbsrIsvdvfk8YnW9h3Zf4+9FI1Z5Ub57g4ZcJ2bP7w+Q99TqeZz4lzmE5Qb/U2KXBnbmIVPbdnMVokNdQ2ljQ0XjCtyvpxUW09RRzqs+LRIknb1VG4lW1XVtV3jiZWMJ2k9kf/V648uP1wCCVB1mrHJDLkaUlWjhaslnoGu6NNdJY9gjJBrk1n9JNwI3kknfGjhkQKpj13W28TAjpQMkxWVnfxqP4xLi31va5Vhrk7hm9leT7aFAQezMQI1u+28hJKCmO8o7U0ovqaBdc3xwaU0Z2HiGpVP3LafhzNgFGwxaWjNfVK6c5DfLdWwYVHrFotvWAUuktg4dHEaWEM3dH/afV2TP14xOjwso5wAyWHLPxnqIGZI6VmwSjDnRn7B54YDNiaqT39ffgLIcKl+fwuBhOiW5SOwcZpGOHSqAk2LwClQp+zyIxGMwqme6artThQenhoZ2EwMO4sRsECQO/sxB3I544f0wpbWHjhbWqI2aX9gFzYJSyvvgslxXTRicpExl0etAH4EkqL/t1UBtJMpGCUcK417ZbSrYMQ7V64ESOD85GC5dJSS2uiwNnKAZSMrPf2aJemA7nuGhTP2i+dlRGb2v/ncRed2JMWHcj1kE6prMxXNpp6coBxPI4bkxiXpkj/hR4M4OBtef3i6zFiMcTL/cR5v7sTNyzxLG2wMkions3Vtendfm5aw68SSCAx1SIfbl1r6Ztv6c/vR1/JZXUdvY/nMAcs/uw38s3R76MMcyLvrt8ljU2XTItIbRAt0f+Q+KvmCa9vvGXaNuSnfvrdF6nGp+mkVmwpKb0CYwfyPWvl+WzcW9WTGMVCz0/9pCRTQlylMSgfe2H4aKq6i0QoqGghnpnqSbImxFOlS4eo+cxrdQqlMP1cbVOG/oBVv6Z05sf8wrnKqvzZL5zBOxI75kUc2JtBv9vO8siJiloCS5uLWgiXHns0VSWdEvqwsk9rxkF04cyMilr+J6buYoQWveIylXi1DnjLuxbwl4EHmYNw/gKl5uxMy5ZGqKxuHlNIdD+5p1rw6AaGFONmo4sfOhRxdBJ+uOAJtPUMKveH0+Sm8yo9dILEeXGlh+oANIkL6+Qj+D/8uS0pp6ylWScnP6FDiikffiwjfJ3F6kG5Il6pu7hcum8VUVYxkwLxKu2jkvJVKoXDg2LSteDleCMpukh7qcvBuvKKrPVasGDBgqfIvzowNmTgJi8YAAAAAElFTkSuQmCC");background-size:cover}#toolPanel .round-active,#toolPanel .round:active,#toolPanel .round:hover{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAACXBIWXMAACE4AAAhOAFFljFgAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAASrSURBVHgB7VrrUdtAEN6TB5Pn4BKUDuwKAhUEKsD8jJMMUAFQgfEQw8+YCoAKgAqgA5QKYn4SYl1272Kw7qGHJVlHRt+Mx/b5LN2n3dvbF0CNGjVqvCAwWASGvA0TaOPdfGjACr63xDiHMY7f46db8CCAL+wWSkY5hPu8BUvQRRKfIBREW6n/y+AKH8Qp/Mb3XRZAwSiW8BFfRQnu4YJXoQgwOEcNGMA3dgUFoRjCRRNVQVJ/gK0iJJ6PMKnusiC6k2J2gPMCvGMwM9bCsRaOtcXnJDA4hB7bhRyYn3Cf+9CES/zkW2aM8UUqeQ3v8X2LjWOvd4LXC1FDSEsYbMbMDHB/r80r7fkIkwozOLMYozEufADvUBpJJG2YkmdCe3zLPTbm2dvZCR/zTVzEyPhbCAe5iJpwxPfR2u8Zf2N4EvTYKWRANsIkWU+osXoV2p8bpZ2jJHGO9zVJO0T1ziBpL+1EsWdJjVXQmfkaOqU6DZ9xvz7gPeiYUuHhmmhtKZFewkN+B6qBIrJfWRcWie98ZDBqZMg6aMgSt1I6CR/zPujW+HzhZAl0T3rQUfjieEyBZMJ9sX+i5yzt2TfoCFSFR1xP9DwHsUayMQlIJrwMP7QxhoaiSEucFaS6ZCRVNJKlHE+YnpjuLh4II1I1yEjSMTgLWmuClOMJe7Ad+c5ECLcPruAPnvnSo3tGgpTthKWpX4+MceWJVg1SbfLqZkFSJh/fAjvhpiHy8TBqcQ0mKVMsboGdsH7WjZzYuyqkAbuIjFHiwQI7Yd1YXYOrCBXN4yLcNMJMmHJQ+swrcBUTzeVsGTmAjXCoeVVjJ9V5CulSBpGxCWQgDMpkBqVnE3ND9byYOTFhIxw161ykUt1GCD8j3z1zyshMWM9k/IKXhxXTYPp4+D+BmTCH6gKDecE0iRq3oU3CY+ViPrgOdRuGZqHZJBwo331wHbqzYTxZzIQb2mQ/ziGvHDLQia7PU4T2NGyCTMipYdc6uApToGNJKsYFD9E/NOAjuIvo2pjdDbYTDpUIhGJjF9VaqnM3MqYn+Z5gJ/yoVRdaqDo74Boyxu12wuSQ66qx7aCU1ZTORVygE+9pTbSUjltSHnIi60fGQpEBsSK58nDMLw3JgM4i+jFiIcu1d5Ex0sgeW4v7W7IvPTEm7s4qVW26d9NY1EssDiQTpsqcmhkkNWpCH6pCUxQHfGV0kCZJka6YJlsbbgwu5ghVe7EllyEnst3IGAX/PfYhzd/TVw9lVf4GVBeOSpiy4aTcCEuqMWlVV/lljHraSZuCKqYgnrPvIhF9TMg1RW3a134rrSBOkBc2qbC0mCc8VckyNUiqdM2m0CzfMGMra5/H/E0tnnjiJksdABXc8nTSEdFX6ORMRFnU1jizoKaWKeL6Lp4xAkrgpyFPJCkiW8JAYILvtnZFJnq91uZNG+fvxDvih1qV0QQujIsMO9lM6EkPTD40H5IxwEL8fp7adDGthyTtCZ6NrKTWQy4aTg+K6LkshvAUcm+TtItJFhRIdIpiCU/x3Ea4mVHqVAkktb+At7j/S2irKIewCipsyXpV+19FYJpSvRfZRUoaUh6t6oCkRo0aNVzDX2qpg7pu/G77AAAAAElFTkSuQmCC")}#toolPanel .right-top{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAACXBIWXMAACE4AAAhOAFFljFgAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAGcSURBVHgB7dk/TsMwFMfx33M6RCoLG4Kl3KRH4Ah0ZOMKnABu0HIDbkC5AUfIAnTMQFGl/jF5MkMRKpIT59mu3met6qev0liNAyillFJKKRUEQVp5NkIIq0WFFuSCm9DCmOdm4ghhVES7yeZzMff5koGQoqBpwFg2stZM4UksGJZqJEAs2BDdWWsrRCa+aZWem9aabwXQ+MDH1Xb5fgkPAwhbeeyuZng+ba7IGAHJ3cOefmKvEViSwYdj7SM6Si74UKwBTbZbO0NHSQX/F7tevs0QQDLBErFuvQRIxbo1I5OMdetGJB3r1o4kRqxbP4JYsW6GsJixbo6g2LFulpAUYt08iSGJxLqZfQ8IGVuWr82z8f7JyRyeej0A6OXKNgcIg4JuQVRvBl8PqGuvo6PeglP6Ge/rJTjVWBY8OOVYFjQ49VgWLDiHWBYkOJdY1jk4p1jWKTi3WNY6OMdY1io411jm/V/aDC/uc41l/g8P1l79XSSPWOYdTPT7lWdOsayAJ1ucvBiD0+YFd0Vmd7NZfjxBKaWUUkopdfS+ASmNvgIGrsXnAAAAAElFTkSuQmCC");background-size:cover}#toolPanel .right-top-active,#toolPanel .right-top:active,#toolPanel .right-top:hover{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAACXBIWXMAACE4AAAhOAFFljFgAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAF3SURBVHgB7dpBSsNAFMbxb4roRvAK9SY9gkewSymCR9ATVBfq0noSewSPkCP0ANJxvropaISXvLx5A+8HbUpDAn8yCWESIIQQQgghBBUJ1l7zHBpuUocB7ILXJfQUH+XXHDo67LHEbdpKNprByhneoBeLw75mh32K2AVn7OCAXTDwUE6gDpX5v2jlMmwzFj1rO6zSJQROYE1ydX3OPEcXUGQ5pGV+Yq+hzGdwX2zGO0byF9x/ZJcleIORfAX/F7tKGyjwE2wQSz6CjWKpfrBhLNUNNo6lesEVYqlOcKVYsg+uGEu2wZVjyS7YQSzZBDuJpemDNWO/8Fm+j2dOthCadgJgiiPLCYQ97spnh3M8YplEU0fTBTsaxsemCXYaS/rBjmNJN9h5LOkFNxBLOsGNxNL44IZiaVxwY7E0PLjBWBoW3Ggsye+lX/IajcaSPDjj6o9/m4glefDvR57NxJL86WEqgXvcl+VFWT5JXzkIIYQQQgghtOkb2FSXUxZQW5sAAAAASUVORK5CYII=")}#toolPanel .brush{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAACXBIWXMAACE4AAAhOAFFljFgAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAALESURBVHgB7ZlLbtswEECHpOykcQoIBQok6UY9QZsT1D5BkhMkOUpPEPQEcU+QLLtzdt26J6g2RQt0US0qRLBCMTMGHMiybJPyjwT4VtJoCPOZ1FCiADwej8fj8Xg8m4GB5YjOuytQxZkC+MgYxNjh4ZNUXyD7E0MD7BUOw1Dkr+6wi92aqzGH/CJP/w7BEDuFUTbIDwY0qguyEpTumUrbJ6wnO8FYmoNNzJHF8wSguMaD+2qLAlqDVuetzp8zxp4RXiBbAOtB+ms8iqJz3MduX1ZaJ1IWpzqFTIANaMqOY/n/e94+fI/S5dx9xoHhtW/Lfmr3U9pAdoJMf19hxtdyjAE7Aw12K7ygQDGurutkJ0ip+pVQBBrsTnhZNS7YDewfRXPbCn5TDilQWpV6N8J6S08kBB/MSM9pi1PaUuEF96xSKq5kT0vPbatirNKfQYPtLkvLCpSUCedswBiLKi1jOcovgnbrtk62kKqn+2y9PWHdaoyjOUd6BlNZYjvCpkuPhnQTWWLz93CDdZYkivbeKebUFqKmssRmhZvIvpDUdm4VWWJzU3oV2QXVeBVZYjPClsoS6xe2WJZYr7DlssT6hB2QJdYj7IgssbqwQ7LEasKOyRLNhR2UJZoJOypLmAs7LEsY71oG4s13V2UJo5cH8fr43GVZwkhYSea0LGEkzJj6NB3BvWGHZAnD92Fe2SlUTskS+sJhFGJ3w3JIjmS9sKWyhL5wls3uIec1nyktliUC3UTOeXc6oh5eDlES0lbEg6DLc3ZpqyyhLYxPKB/K5wpYKDont7h53mU5i6A9iU9jkyyh/aQlDk5+YnYEBtgmS+gJY8ES+egfGGCjLKE3pbMsBLG8vtG3Idw8f1CF+lHsPfYhTRKwDJMpfYfZ55PzshwXavgUZENI7BOsYvS2FBwedZkSSd5KYxfkPB6Px+Px2MUzbTi7WUXRE4wAAAAASUVORK5CYII=");background-size:cover}#toolPanel .brush-active,#toolPanel .brush:active,#toolPanel .brush:hover{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAACXBIWXMAACE4AAAhOAFFljFgAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAJySURBVHgB7ZnRbdswEIZ/qUFbBH3ICN6g7gR1J0g6QZPHon1oR+gEQZEGeUwyQbpBMoKzgTaIXxMgZu58cGDLknwnWfYR4AfQtiiS9meSR9oEEolEIpFIJBL9kME75+GYPuUhAob0XFDOGI/4i99ZgRb4FT4NB3iHGxIdVdwtKH3Fj2wMIz6FWfYtbunVsKHUhNIXq7Q/YZ3sHLN0Dk/Uy07wjBPqnv+l/ANKtzTPNV/ODD893CS72Iv/whV96m8rZZ7wSRPIfPSwVpb5mR1TILsuleP6v6Bg98IW2TnV0odQsFvhpgA1pTnbFIwCrko5AyjYnfC6aJzjlMoMauvy/WVUkXo3wrqlZzArU5aur+tUuGnOytZxkWXpurpcL8cfKNjusrQuQOX0HOh+WJmPBXgrCVyiSjajut91e+vtCWuj8QX1ZrX0KkZZqbINrEuPRrqFLNP/HG6zzrLEI+2c6gJRS1mmX+E2suvoICvV+6KLbFM07iArTfSBU1lpZtM4lpWmNolzWWluU0QgK01ugkhkpdmuRCQrTXchMllpvi0RyspbtCFSWXkbKxHLMva9dMSyjE34LBwhYlnG2sNRyzI24Tf4XMq5jkmWsQkHwz+FDmUZvTALyOHVIuPasg5lGb3wXsV/yFXD2bEss2coO1q6ynD3+lokB7PTejnZcynL6IVzfFy6DjS8L8IlnQGNMD/XqdrGOJJlLD08XLmerjmldybL6LaWMmQfYMGhLKPr4fc0fKeqkgWlOxru99in48yTbAJn6H88nIcbejxayCkwlwu0PH2g5FCwjO3X0lkYzQ689kk2ArlEIpFIJBK+eAGdRGPGDQz7SwAAAABJRU5ErkJggg==")}#toolPanel .mosaicPen{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAAAXNSR0IArs4c6QAAAOtJREFUaAXtmckNwjAQRcNSBg3QCkVRIXQBZxogghlxQ7Zl8YKSSG8kX2bx8r4PtmYYNAlIQAJLJXCOjT1jvGYet1j/FKNom6L348zN7xrx3tC1N7GSdwz/I8ahEq+6pyJfXaAzcIm83EvRtkXvipweYG6xVEAFIAGvEASIy1UAI4QTqAAEiMtVACOEE6xegdb58w2eb3Fqf/1XrF4BD0DvF61XAUqQ1qsAJUjrVYASpPUqQAnSehWgBGm9ClCCtH7fmOAesWwuTPEnaCzTFRq7sr6Ssq2T7Z2pPiS/zpOdomx3aRKQgAQWSOANmudym8Lt+O8AAAAASUVORK5CYII=");background-size:cover}#toolPanel .mosaicPen:hover{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAAAXNSR0IArs4c6QAAAXxJREFUaAXtWU1Kw0AUfm90UeyuIih4Add6ATeinkP0TIrnqOLGC+gtFASxu0o2zpgpSUngvaTtS6YtfFkl37zf78tiZh4RHjAABsDAOhlgLfnBS3btvX8MIRxpNilwJv50O+72+2IwlvLtSmDEiuIPtfVlcGZ6X8a+ZhvoxP/5hxw7ruHFh9pAhfkxDfhucr73IQVowkZP0xDXfy6HZ012TWv7z9O3EOhUs3Hawhxfsfi5f88vrQ2swnzPNdfCtzZQs97ADzSwblGgABQwMoBfyEig2R0KmCk0BoACRgLN7uqBptwKmzN0FGByNRRr3fpfSD3QROLiScpyGClV1NhbRJwyhma79QqgAU3aVDgUSMW0lgcKaMykwqFAKqa1PFBAYyYVDgX6ZHr0+iteqVdzbqwCs+KzcF8tVnpXt9NxMkL5cCHez0uOi2D5vf7sadsSi7GywpkoMPOXaJODagNxrBMnI03DBS1ol3gs3jl302VMxAIDYAAMdMfAP+EdVKaWg/p6AAAAAElFTkSuQmCC")}#toolPanel .mosaicPen-active,#toolPanel .mosaicPen:active{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAAAXNSR0IArs4c6QAAAV9JREFUaAXtmU1KBDEQhauiC9GdIih4Add6BhnmHOKhxHOoeAY9hjAgLkfcTGo6Mo2ZpivW2F3GgZdNJ5VKVfK9XuSHCAUEQAAEahJgLfnx0+c0xngnIqeaz1/Ymfg17ISbt6u9+758u33GZFtN/kTr38TOTC+b+K/5Cp3HRbxtbGdr9lVDXcA3ef4gkv2+wVbb++Tg0urb9Tt6nD+L0EXX3rZDW9G/wyavxx2nx7CAcRJ5RcECvMha40IBKykvPyjgRdYaFwpYSXn5QQEvsta4UMBKystP3U6PmfDwYS6/jddspYtl63+hogLpJDXkMDKEfBF71rn1CmABmZpVqlCgCvYsKRTIYFSpQoEq2LOkUCCDUaUKBapgz5L+cwXS1X65qNvp9DJCzeNCup8vh9B7fzqM6CPbnq+rfWHmWWvpftUFpGed9DJSelzoBvNop8mHEK49YiMmCIAACAwnsARsm0C5E2sdIAAAAABJRU5ErkJggg==")}#toolPanel .separateLine{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAA2CAYAAADgQzjYAAAACXBIWXMAACE4AAAhOAFFljFgAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAApSURBVHgB7cixEQAABARBr3H6NEJ9IFWA6C+6WcgUWQ6F7aucCATCLzSr6QQMe0nWygAAAABJRU5ErkJggg==");background-size:cover;width:1px}#toolPanel .text{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAACXBIWXMAACE4AAAhOAFFljFgAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAANiSURBVHgB7ZnfUdtAEMZ37zAQlMyIh8zw5yGmA5egVBA6wB0QKiDpADqADuwK4hLoAL8k8BY9xEyIo7usTAzW6Yyc094lk7nfDMx4Ldn+dKvdT3sAkUgkEolE/hYIgRFbe6eIOqOvHheduxPI8xz+V2Sy35fJnp7/iWT3DAITdIXl1t41fWN3IZTTKh+EXGUBoUj2e4bYklTcv+hDQIIJlqCPbXEU8A4CEm6FNWT2NzBbe7mTQSDCCN4kQfV0fkRpPIRABBEspTh67n0EPII0TSEA/gWn3VJIv+koOU2CrLJ3wXI6rQnRSp/Uj1TPZgEXAVK6LkRpPSDZo2oUM+i87oFn/Are3OnOhFQgod9vx2QvP5qHi07He1p7FSzQVn31Zfn/57fbEV2MisNChGPwjFfBiGgKyIvJ7cX8hdb63Hg/9d2T/Qm2W8nB4guFODBP0xpPwSPeBNusJKK6rAQmn6+sxctjT/a3woaV1KDHD/etcZiCoRkTP7begye8CJavdg8t6Ty0Has2Ni5CFi8/K6yw9gSkCm1/2M/HuQa4NKLeihe/4FnvrVpJSuersvcuO0VgEax4sQuWUmZmDKHWfio83NthipeHlK5byaKAUdNZoYoXr2CbldR6+Fw6z7EVL4H80xBWwVYriXqw0smW4kWve9zFi1Vwk5Vs/DGW4sU9DeETbB/jrLa6vymLF63q1WKMexqyBkzYxjg09O7JZPcT/BHYnSXzE7NRroKcZWjPNoi3DNkZ0aNicvMWGGBJ6SVWkhG+US7PPWyxktxwFa/2KU29l+7f68UQ3YE59d9W+0VU8btGiGUfqnXRerCSlSJDV1GdFHertyMbtK36gZ6aFv00S/FiSGk3K9n4qevrNWEc+1DtBLewko2Q8/Ixym0lWAjRrwVXtZIr4GOU26pomb23HOOoyc0BMCKT/a/0yYtOi+zql21wxH2FLVaSbOAImOEe5ToLtlpJcyrJAPco1zmlQ6Tz43fN/Hi1OFJP3nbpyU4rbLWSGtlX9/GjGachbildYH1HUKkL8MSSUa7T9qqT4HISYURGLL13GUtGueCAk2Dqj+NqRHtL5zmqKM6oYo+ffgOcgwNuRSvtpnJ6X1q/N3TFhtPJDcvDeSOzBxXISKx12yYSiUQikci/zS+amzngvBJLrAAAAABJRU5ErkJggg==");background-size:cover}#toolPanel .text-active,#toolPanel .text:active,#toolPanel .text:hover{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAACXBIWXMAACE4AAAhOAFFljFgAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAALxSURBVHgB7ZnfcRoxEMa/498zqSDnDijhOkg6CK+Jk0mowE4FNsMQv5IOSAVxCXQQOgh5tRMUifPZ3GnhjLS7ftFvxnhOcMCHVrufVkAikUgkEomXIoM2N+YCBoX9W+MOE0yyDRTpQZO5GWOLy8frAf7Yxy9QpANdLhrX73BlhlBET/DcjOxj3hgdoo8xFNGc4c+gv8EbKKIpuCBHXQKbmQJK6AguBeU4/C3eQgkdwR2bnI6jlrzkBZdCxi2vGqKrM8vyggeEEGMNR5NeaxSwIC84I4R0sbTjt7Uxl7zK0iWKrOArk++E7OOEvs/W+IevxB3iYS0ruE+G8/fd/0/ZrX1s+mi6VjMiKzjzBGxwni0er7aYNp4fStdkOcG0lVyi/ulL776u57dZkZxhPzy3D+FccZ6tyOQlWJMlBRe1q8zuf8t1W2eLH97YQG7LKCN4ZlyyymtjhhDmuMcCislLRjC1A+rgmnyt63g0Q10wefELdrXXt5KrXe09jFry4hc8ILeB06P3uLWtlLz4BVNWstMQQ6GUvHgFU1YSVsjxcC6hkxd7N4RXcJ/0wks8Bzp5jbiTF6/gNivZjv/jMHdD+ATTbZznzW5FaUxWjVHWbghfI55u44zwzfzEKWztj1Y/D6lauddggPPkoSDGRjaJnQZ1+FMaGRbBPCFNWUlOGFu5PII1mulMySv+9NDV3gF+NUY38GvqqeTee97hLPa0MX4N01ZycmI58pmZSzur+36aJXnFh3SolWzjLyGMYenECY6xkm240BVo5cYJ7pEnCqeZjWMItHLjktbcuGSV773bGh+yM3AyN7/h1u8Tzq6+QiDhM0xZScOwdpswt3LDBVNW0t/txMPcyo1Zw0Xt6lBXMhbmVm6YYLoryT+7FYzdkDDBHbL2LiAF3Q0JOl4NDel6LaxOBKU41MoNIEywW6/7SIZzRc86r/rnThFAWB12CaO/s36v4ZzVx4xlr9rKjXV29zZhSSXIRCKRSCQSovwHybzXUxgaB2wAAAAASUVORK5CYII=")}#toolPanel .save{background-size:cover}#toolPanel .save,#toolPanel .save:active,#toolPanel .save:hover{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAACXBIWXMAACE4AAAhOAFFljFgAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAK8SURBVHgB7ZpRTtswGMf/tgsrpUzRnlqeshtwhPYG2xF2grGnPVJuUE6wM+wEYyeAPe6J8LCBtIdFKmhdS+PZliaaVK0TJ3ZK8E8CtV+b2L/Yce3PATwej+cJweCaIAgoffWR7XbfJKz7HQ93MRzSgmPYrHMBgpCLf4zhaAEM4RACl7R7IWP0ajm0WPAQ05trOILimeGFm44XbjpeuOl44abjhZuOF246Xjg3YiGv/lxTslwjYbrXf8/m+1ds3vlNO4cncESq3L3+MQwoLhyEAaFkDHB1lQnByIW0LCNVLiUnJi1t2KVJKg9lW1rJijIyYaNuXVw4jmKO5DQbtiW9RlaWd4o4LpwANGrh5P5mrApcrUSl0ptkH+5+jmCA8SgtC7QpbUNWnRclsCVtS1adGyWpWtqmrDo/KqAqaduyqgxURFlpF7KSSveWktnknL04kLsZg+W4qPSA7ByAc/6NUpKaIXGOMd19eexCVlL5ZtpGaUoC8cFRKi5jBCvTRBuyEr2wwW7fWumM7NpYEdmC9dPuHpru9skKt7qHsssWGqmLtmzR+m3ePaxgt09Ij/JKF+7GBvWzngBYN3pnsXXPZnGS8dBJu5KVOEvxbPiddiYrcZrTWpbmYqFJwT+4lJU4f8ZDCQbBWL5ODNazZXEurKhB9D8+TZtiehtlQ60Wf43tIVyJaOYIOVqYn6feceIsLauDUfpp+T0Hv9Qdo72HheBXOfF/jJAB2+9/ETMaOdpGqAcxw1IXPlwOEvAz3YH6B9NEHprO/l4QQkJsMaJ1I5Fc1N5u+i4t0rKM0LfZXPQ2IX/TE8g66sk1Ss/vf1yKLw7FAj7ClqFaFmQIUcc838+dAEjmk1vOup9bFNeigJ64F3qoEXnxRfbkbLHz5x0mv6K8x5V6uLQtlmeogWl7Gtc5efF4PB6PpyL+AYIPPUb9sB23AAAAAElFTkSuQmCC")}#toolPanel .close{background-size:cover}#toolPanel .close,#toolPanel .close:hover{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAACXBIWXMAACE4AAAhOAFFljFgAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAG2SURBVHgB7dpBboMwEIVhiLquyqLXibhZ6c1QLtIDdEFPAOUtkKIEkMee95zF/FKUKk0FX4xU7LhpoiiKoiiKoqhOP33/gUdTudzzuFjePF2vX+/LMuGBn5tKlZxHm/rGaf005/UA969dlmXobrfvRhiAc9sO969d2rbrxvEv5e9NI/wYDqwc6T2stWQwPsH1YE+jqUIfYXFOqaOLki/prd++H9ZL+QnIvLzPsJ/jODSGzGCkRHtiURYYKdDeWJQNRkw0A4uKwIiBZmFRMRh5oplY5AJGHmg2FrmBUQlagUWuYJSDVmGROxhZ0EosooBRClqNRTQwOkPjWY1FVDA6Qu/FxiI6GKWgFVgkAaMztAqLihYALL3N85LzO+8kI5yyUqFaLqKDLcsyCjQVfPZ/Fs/qlRNEA6fcVNRYLqKALXdQarQ7OOd2UYl2BZfcG6vQbmCPiYAC7QL2nPWw0cVgxhSPiS4CM+ezLHQ2WDF5Z6CzwMqVCm+0GVxjWcYTbQLXwG55oYt2ACDl5P0QLdwBIMMiHGvvS3lL2TsA1NitR7R1B4A5XNrTC2xbepXziKIoiqIoOuwfOs4hnf5I1CMAAAAASUVORK5CYII=")}#toolPanel .undo,#toolPanel .undo-disabled{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAACXBIWXMAACE4AAAhOAFFljFgAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAMVSURBVHgB7ZrPbtNAEMa/3bVj3CQUNWmjtqoa7vTEiT4AvbSvyUNwoZyQEOXSikNEJTi0ARqQkBunTuwd1hEtdkOzzl850f5u9nq8/ry7s+MZAwaDwWAwGAxzgmFSVqqbgL2FiHsILhrIORYmoFCqPQsl3+8fCAlZrDlofz9FjuEYE8vdfnEn9hbCLnLOGCO8XhKudSCZrAy28SZyzoiCH68Jlx8QQ/l+iyR+is7FCXJOZqeVWq/JG0gKIkEf8752b8kkOF6vagrvDRgz6kYRjlEKf2JetDYC4FMXY6IVbDkbL6UQdeQIRsxjJJvhTfQBuLoexVYMb96uwGH7yBsMDjFW4Zaok4smut1OVlPNtrTqqWkbIKcQo7KQxSOUy5WsNpoRvoqIFSXjbAe5hQkunR0Kdxrx82qvRhbUG1Rv8pCIOSnjvtNib1Dq/cK8CIKCiFb2CXwzeVoCJ/Cb2m1xhFi6WhauOCTGB/dgwY/hzTeOFiu1o6To/stvr73SeXDNlE7idyl0v3KL1dXd0yNNVLfsMmTvem6RFvXcJrNFYqtkggp+B732j2F2IwiOiUXvNrjt11QHqZEmYIsKxa6uw+nhd7ld3Eo+BzEZqf7Ph1mNKDhGObJeu0HWakFNo1qyJUuH04S4C8b/xQichKDQOxtmM/bXkoqb3/UdRRJpe5gngZOK8OJtSmcyxggnUGuW+COPRDyl+Tk6l+8xVxwrvY7Vc6w+asD3H3RcEyUA+gStBgLkPtNxy/hTekExgpcdI3jZMYKXHSN42TGClx0jeKFYQWngXKs19BN1sQVH6RpXnNfSmSy0YAv20+RxBHmps1lgweslKe7Vo0P7i85qYQXHNeqBk0GgzZpOnvEYRrWqzTGNjI+SgHiusqSp8oqUpLIuLW1ObUaC478E+BH5fPqC0U8Jp4iribjpZSrGz0awW9hTKduZiL1PvyB/c/0a8DJlTGc7pWdMPLJ/xWYuyE+Wpn2I0Pn9v5LMtJAkPVUfPqNO8S3wbaRc+OQ/pg1jFk6r9UQFF59zW7M2GAwGg8FguOMPg6ATjq272toAAAAASUVORK5CYII=");background-size:cover}#toolPanel .undo:hover{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAACXBIWXMAACE4AAAhOAFFljFgAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAKwSURBVHgB7ZphbtowFMef7aajjTTxZVJLv2QnGL0BnID1BvQEYydoe4K2N2hPwG4AO8G2Eyz70FFpXyINOiaw356RJlHDcBJIlkT+SfkQO8/4j59fbL8AOBwOh8PhcOSEgG2pHbX4/ssuXQHOfn6GKsMPjt8Jv4F/L7rvQcHhkBLun1wzzm6WyxiHDhScPUhK7SjYE7yPgE2zijH2EQoOS/S0f9IUiH2yClYaYng7H4+q49KL+Qr4yRSLABEHfF8GsZpYI7yYr4DrBEXA8VzOML/oXJtGEEURpMQqWBw2tAu/hWIR0jWUUl3B9DFMYrhZsJ6z2o2LS8hhdjab/IjtYZvnsOeF9J+kdp8cCBR4A89/1YxrsFlwFEYI5DbFpk6i+1Cv1+M8HCtoeeTaCmBAMdlsdBG0vByDlhSCBKpr6npruRwRrtTT90ubffz3MC04OGcDWlwEq5WqKyeP95Ajwj8eGKIj6T29tkXw+EtLioZKYRsRwzXN3PHDxgXkiJR4bhTV+e+Drs0u2Vpai95/cUoONDSrGIPLXDcPi9fR835QH1o2s+SbBwpkcjJqk2vfmlVxfnC38HujA2+sFpCS+fihRwKfRXDaLYWQIxLADJaBzSbZ5mENwj/qAvIOif0yH9uj5E6hQCoE/7pcRHM7gOno279Mthb8X0khOLVLlxUnuOo4wVXHCa46TnDVcYKrjhNcMoKVkg0bB02pBQshAqPIeqRc7hFG7Bj31uxleQXTXnglBcTwg82stIJ1jtoskxKGVjvIEj0Ku4dOOdgFpWnN9MpdnMRaNoL10Qvng3WJ8yxAwFBJjJUSysSluRC9/MRCpICfxU2bljpKL0YWWBsmDztKl6ZESXmzPiWzG3Tb+kxceb9Ok4jVZHpMW8sgaE23/OTB4XA4HA6HIzf+AELL5fDBKGTPAAAAAElFTkSuQmCC")}#toolPanel .confirm{background-size:cover}#toolPanel .confirm,#toolPanel .confirm:hover{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAACXBIWXMAACE4AAAhOAFFljFgAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAALrSURBVHgB7ZlNctpAEIV7RPhx8IIjeGviVMEJHG5grxKchcUJQk4QcgI7JzAsAtk5N8CcAKfKga2PwAJVDJQ06Ra2y4hBaIRURlR/O3pGo3makfSeAGAYhmEYhmEYhmEYELBD5O9+mpAyjsF2etbR56aqz84IfjvsfBMSGs8Fx6mpRBuwAyyJJWilFbyBhJMfts/BK5awoafqn+gtjfdsCQyj763jan8fv6s2VMckdkvPxYquty5A/lgldt6eQHL9zoGRhS5O/sDT1LKKVdPv2MQJXi1W3FrFT+V1xydqS/us7H168q8SZIzErHChf1WYZnN9lVhbQOXhsHofZJzErPAsu9fdVCyRCMH5YecKQJY8ZW2xxNYLzg9+XaCxMBercoTW8VRXLLHVgskyorj6UoMjK+iTbyEEWytY6Y8JB2phxRJbKXiVWLKM1lG1CRuw8rVEr4FZOnNiz4ybh7L+vRKWeRgQTW/dzx/roBRML/hUVqIpFwW3kw2V8fvqDcRMmDCgi3JLp9L0oJiLJWRKXLuTiZGwYUAXpWAp8LG/WCnglb+mlYcYoHEljv/yIj/SGhfP6hAhSsGZ6fQSRXqfhLjNoRu1aP8w4J98wqAUPCrXRunJpBK36CjCgC6+4SE3xAlJ9dWnCdGFgZBEFQZ08X0P00kdPLnESSy2yBKZeZo0hCSqMKDLWuPhKzqTu4AQRBkGdAnktGgSAs26a9pfIsB0zb0GUYcBXQJbS/Kvwhanyy2yPjf564kjDOii5aVdt4Xm3Vsn37tOdFxhQBft8OCad0d+9dZJzN6grTQJcYYBXUJ/09r/22lIAcurKgzTOvzYevoZdxjQZaOPeKtESxC/Qdp/hIH/70j4sHTSVxLrnhs2ZP+ufSkN8SVofzcMROyPdYjkM21+0G7iUOcBurbi8Mc6RPLFwyqembRN/fq4D6hXFuvOAyKEvLeQ8kSAcYxbt4D38kiC08tOJs1NfDfDMAzDMAyTBP4D55plBOlQMmwAAAAASUVORK5CYII=")}.__screenshot-lock-scroll{height:100%!important;margin:0;overflow:hidden!important}.ico-panel{border-left:6px solid transparent;border-right:6px solid transparent;border-top:6px solid #fff;height:0;left:23px;position:absolute;top:0;transform:rotate(180deg);width:0;z-index:9999}.ico-panel img{height:100%;width:100%}#optionPanel{background:#fff;border-radius:5px;box-sizing:content-box;height:20px;left:0;padding:10px;position:absolute;top:6px;z-index:9999}#optionPanel .brush-select-panel{float:left;height:20px}#optionPanel .brush-select-panel .item-panel{float:left;height:20px;margin-right:18px;width:20px}#optionPanel .brush-select-panel .item-panel:first-child{margin-left:2px}#optionPanel .brush-select-panel .item-panel:last-child{margin-right:0}#optionPanel .brush-select-panel .brush-small{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAKlJREFUeNrs18EKgkAUhWEnwmW1amObHqKeo0ftOfIh3OSmlba0xXSEK4SICAoz4X/gINwL8sE4C533Pok5myTyAAQIECBAgAAB/jdwO/cFO3dsH3v1qmY2LtWHWr/9KyxQOag3Nf2ZnQ17V6vQR3zp4bqktgv+DWYjuxO3eELKkd0zBmCuNgPzxnbBgZXd1kL9WIslbnAbx38xQIAAAQIECBDgqoFfAQYAhLQbgzDvXkAAAAAASUVORK5CYII=");background-size:cover}#optionPanel .brush-select-panel .brush-small-active,#optionPanel .brush-select-panel .brush-small:active,#optionPanel .brush-select-panel .brush-small:hover{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAALhJREFUeNpi/P//P8NgBkwMgxyMOnDUgaMOHHXgqANHHTjqwFEHDm0HslBqAB+jGIhSBeIOIHaBCu8B4gogvv3p/yuKzGektMEKdKA6kDoBxAJoUh+A2ALowJsDHcVtWBzHABVro9RwaoTgRxCFQ/oLMAR5R3MxAbAHj9yuweDAamiGYMCSSaoHgwNvgHIrEK8D4s9QvA4qdmPAM8loVTfqwFEHjjpw1IGjDhx14KgDRx04pB0IEGAAHeMoHW2kl/cAAAAASUVORK5CYII=")}#optionPanel .brush-select-panel .brush-medium{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAS9JREFUeNrs2EsLgkAQB/BWupQQHXpczbp36/EB6ptH1M2D17RLhx6XQG9lszCBxEa5zoTQDPxvjv52RR1UWZbVqlxOreIlQAEKUID/Dqx/e2BL9d4t0MP0IS7kBkkgZ0iMub82XrMjLdBQGjXTdgO6jRlpC2QDiX51ixVkClkacMbNhyywR/0COIGMLfrG2MsK9C1xeaTPBdTHzgkezHmR6zoFd88lAOpzDDmAHuHrzeMA9giBXQ5ggxDY5ADeq/4tTgmvm3IAL4TAEwcwJgTGHMAdTillK8FzsTwkawLgGkcylm+xXnlQAhcU2T3baWYLCS36QuzlmahzpX/mrCAHnPE+zYRXhO1strzMRK0n5D0OEQNIJzdMPEf+CGHWL3klf7cEKEABClCApeohwADD8zb9WRTsHgAAAABJRU5ErkJggg==");background-size:cover}#optionPanel .brush-select-panel .brush-medium-active,#optionPanel .brush-select-panel .brush-medium:active,#optionPanel .brush-select-panel .brush-medium:hover{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAU9JREFUeNpi/P//P8NgBkwMgxyMOnDUgaMOHHXgSHcgC7EK+RjFsAmzAXEAFFsCsRQQ/wLiJ0B8HojXA/FGqBgK+PT/FVH2MhJb1WFxYCAQdwGxCgGtd4C4HIjXkeNAcqKYGYg7oRaqEKEepGYtVA8zzaIYCbQBcRkZ+mB6ymmZSULIdByyI0NI0UBKGgRliLtALENhxnwKxErANPiL2iEYSgXHgYA0EIfRIooDqFi8BdDCgaZUdKAJLRwoQUUHStLCgb8YBgCQ4sDnVLT3OS0ceImKDjxDCwduoKIDN9DCgauhrRRKwVOoWTTJJEVUcGAhEP+kVV0M8nk3BY7rJiX0yG1uVQLxFDL0TYXqpXmT/y8Q50JbJXeIUH8HWo/nQPWSBChpUcOa/KHQ1rUxtCEAywhnoU3+1XRp8o/26kYdOOrAUQeOOnDUgVgBQIABAPYuSgtJpajwAAAAAElFTkSuQmCC")}#optionPanel .brush-select-panel .brush-big{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAaNJREFUeNrcmMFKw0AQhpOqRdGUCloD2lMv1T6B6RMI4sOK4BM0b1Clh56skFahpVaUaln/wBQkzKYmTbJTB75TSPJlN7uzM7ZSypIc9sYIVuxa0nsdUAcuqIIDUKZrczADExCAJ/CW5OFTNUolaIMGaIGThB80BF3QByoPwVPQptFaJ8JR7YDnrAS3gAfOM/69HoEPFusI7oIrcJzTGngB9+AzjWAod5PBlP5lym+jkqsEt8E1qBW0m4Q2d+A7KljS3OAVKGfRuzzuQkmzWpsG9uQmvTtW0KatxFS0yUEr2ChgUcRFlRy0ghcC0m9LJ+hQXjUdYQqtcIJ1QYeYM07QFSTocoKHggSrnOC+IEGHEywLEtyJyySi4rfgXJDXFyf4LkhwxgmOBQmOOcFAkGDACQ4ECQ44wamQURySC7vNPAgQ7MYdt/pUxJiKCTloBRUV1abCj3YduEwSVvw9A3I9bqHqUl2HSsGiYqSbuY0t3JexR62Po5zkXqn18ZG2N7PsMlxaQptH0TrBs7Jpv/mrMte/bGByx/LiWsBSQ7zgjwADAPqYqQ1c9nN+AAAAAElFTkSuQmCC");background-size:cover}#optionPanel .brush-select-panel .brush-big-active,#optionPanel .brush-select-panel .brush-big:active,#optionPanel .brush-select-panel .brush-big:hover{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAhRJREFUeNrUmLtPAkEQh+/UghCxw06JNuCjJURBK+OjsNVEW4KF6P+iYKGF9rYWhmClKKGg8wGNRu2kA4M25PyNGRKFPb0Fjlsm+SKG3MyXLLezs7phGJrK0acpHgP1D0P6sOyzY2AJRMAE8AEPf1cBz+ABZEAKPMkkLxtv33/1+hJbFOwHayAOZuh5i/WoSBYkwSmo2SG4ABIg0OaqFcAOuLAiaOU36AKHIN0BOY1zpDmnq92XxAsuQcyG33+Mc3tbFaQHr0DQxpc0yDW8soJucAb8XdhJ/FzLLSO4B0Jd3O5CXNOSIL2tUQf25CjX/lOQ/t93sHEkeK81FVznruBUBLgRmApuK9B+42aC1FtnFRCkFjouElyW6K12hs6HkCbBsEKnrLBIcEohwUmR4IhCgj6RoEchwcGeOfL/FKwo5PUuEnxVSPBFJHivkOCdSDCjkOC1SDDF05fTYbBLk+AjuFFAMMsuwm3mQAHB5K/G3DAX02HxtkPjZasz8zQN9mZzcY2Haqdit/HWQdRJaOI/cUDumAd6S1MdnWpzXZTLma2cmWAVrIJiF+SKXKsqe7NQAvMgb6NcnmuUWrn6oKBXaQ4c2SBHOSNcQ2tVkOIDbIHFDi15kXNRzk+Z49Z/keaxYIN3e9m2SM9sco605QlK8oZVaxhTV3iZaGMfpTT8XZmPTAU+hJxr7V4B98KJWsn4EmAAKPJ2SXt/mW0AAAAASUVORK5CYII=")}#optionPanel .right-panel{align-items:center;display:flex;float:left;margin-left:39px}#optionPanel .right-panel .color-panel{background:#fff;border:1px solid #e5e6e5;border-radius:5px;display:flex;flex-wrap:wrap;justify-content:center;position:absolute;right:28px;top:-225px;width:72px}#optionPanel .right-panel .color-panel .color-item{height:20px;margin-bottom:5px;width:62px}#optionPanel .right-panel .color-panel .color-item:first-child{background:#f53440;margin-top:5px}#optionPanel .right-panel .color-panel .color-item:nth-child(2){background:#f65e95}#optionPanel .right-panel .color-panel .color-item:nth-child(3){background:#d254cf}#optionPanel .right-panel .color-panel .color-item:nth-child(4){background:#12a9d7}#optionPanel .right-panel .color-panel .color-item:nth-child(5){background:#30a345}#optionPanel .right-panel .color-panel .color-item:nth-child(6){background:#facf50}#optionPanel .right-panel .color-panel .color-item:nth-child(7){background:#f66632}#optionPanel .right-panel .color-panel .color-item:nth-child(8){background:#989998}#optionPanel .right-panel .color-panel .color-item:nth-child(9){background:#000}#optionPanel .right-panel .color-panel .color-item:nth-child(10){background:#feffff;border:1px solid #e5e6e5}#optionPanel .right-panel .color-select-panel{background:#f53340;border:1px solid #e5e6e5;height:20px;width:62px}#optionPanel .right-panel .pull-down-arrow{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAQCAYAAAABOs/SAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAANNJREFUeNq01TEKwjAUxvHXOAhKJ3Fwc9PVzbWipxCdHLyMV9AD6A2EegRdvYBOnd3E70ELIcT2JU0C/1BI4AeB8pKUhlMiOqAtKijuGqEj2ne61D/jY1V2QZ+IaI7maKywrdETzdAVDSKi/Lp3tGP4hRYRcRPlly1Uech4FgG3onygtEvvwDijNxtqwiHxCp3YUBscAm9E/8FtcBFaB/vgYrQJdsGdUAkswZ1RKVyH6+hDivJKMCTa/CY9DV26DBlX2MTJB/WFK/yEvmjjM05/AgwANuZSRB8r5twAAAAASUVORK5CYII=");background-size:cover;height:8px;margin-left:10px;width:15px}#cutBoxSizePanel{align-items:center;background:rgba(0,0,0,.4);border-radius:3px;color:#fff;display:flex;font-size:14px;height:25px;justify-content:center;width:85px}#cutBoxSizePanel,#textInputPanel{left:0;position:absolute;top:0;z-index:9999}#textInputPanel{border:none;box-sizing:border-box;font-weight:700;margin:0;min-height:20px;min-width:20px;outline:none;padding:0}.hidden-screen-shot-scroll{height:100vh;overflow:hidden;width:100vw}</style></head>
<div><template shadowrootmode="open"><div id="plasmo-shadow-container" style="z-index: 2147483647; position: absolute;"><div id="plasmo-mount-container" data-v-app="" style="display: flex; position: relative; top: 0px; left: 0px;"></div></div></template></div><body>

<div id="toast-container"></div>
<div id="loading-overlay"><div class="spinner"></div></div>

<div id="login-screen">
    <div class="login-box">
        <h2 style="color:var(--primary); margin-bottom:10px;"><i class="fa-solid fa-server"></i> DB Pro Master</h2>
        <div style="font-size:14px; color:#64748b; margin-bottom:20px; font-weight:600;">v24.22 Final</div>
        <div id="login-loading" style="display: none; text-align: center; margin-bottom: 15px; color: var(--primary);"><i class="fa-solid fa-spinner fa-spin" style="font-size:24px;"></i><br><span style="font-size:12px; font-weight:600;">접속 중...</span></div>
        <input type="text" id="login-user-name" class="login-input" placeholder="성함 입력 (예: 홍길동)" onkeypress="if(event.keyCode==13) document.getElementById(&#39;login-pw&#39;).focus()">
        <input type="password" id="login-pw" class="login-input" placeholder="비밀번호" onkeypress="if(event.keyCode==13) attemptLogin(&#39;member&#39;)">
        <div style="text-align: left; margin-bottom: 20px; padding-left: 5px;">
            <label style="font-size: 14px; color: #64748b; cursor: pointer; display: flex; align-items: center; gap: 8px;">
                <input type="checkbox" id="login-remember" style="width: 18px; height: 18px; cursor: pointer;"> 로그인 정보 저장
            </label>
        </div>
        <div style="display:flex; flex-direction:column; gap:10px;">
            <button class="btn btn-primary" style="padding:15px; font-size:16px;" onclick="attemptLogin(&#39;member&#39;)">팀원 접속하기</button>
            <button class="btn btn-dark" style="padding:15px; font-size:16px;" onclick="attemptLogin(&#39;admin&#39;)">관리자 접속하기</button>
        </div>
        <p style="margin-top:25px; font-size:12px; color:#94a3b8; line-height:1.5;">* 초기 비번 : 1234<br><span style="color:#ef4444; font-weight:bold;">⚠️ 최초 로그인 후 반드시 비밀번호를 변경하세요!</span></p>
    </div>
</div>

<div class="sidebar" id="app-sidebar" style="display:none;">
    <div class="logo-area"><i class="fa-solid fa-layer-group"></i> DB Master</div>
    <button class="btn-big-action btn-new-db" onclick="openModal(); toggleMobileMenu();"><i class="fa-solid fa-plus"></i> 신규 DB 등록</button>

    <div class="profile-box" style="background:#f8fafc; padding:15px; border-radius:12px; margin: 15px 0; border:1px solid #e2e8f0;">
        <div id="profile-name" style="font-weight:bold; font-size:16px; color:#1e293b;"></div>
        <div style="font-size:12px; opacity:0.7; margin-top:4px; color:#64748b;" id="profile-role"></div>
        <button onclick="changePassword()" style="margin-top:10px; font-size:11px; padding:4px 10px; border:1px solid #cbd5e1; background:white; border-radius:6px; cursor:pointer; color:#333;">비번변경</button>
    </div>

    <div id="nav-list" class="nav-item active" onclick="navTo(&#39;list&#39;); toggleMobileMenu();"><i class="fa-solid fa-folder-open"></i> <span id="menu-list-text">나의 DB 관리</span></div>
    <div id="nav-analysis" class="nav-item" onclick="navTo(&#39;analysis&#39;); toggleMobileMenu();"><i class="fa-solid fa-chart-column"></i> 실적 상세 분석</div>
    <div id="nav-history" class="nav-item" onclick="navTo(&#39;history&#39;); toggleMobileMenu();"><i class="fa-solid fa-calendar-days"></i> <span id="menu-hist-text">월별 히스토리</span></div>
    <div id="admin-menu" style="display:none; margin-top:20px;">
        <div style="font-size:11px; opacity:0.7; font-weight:bold; padding-left:10px; margin-bottom:5px;">관리자 전용</div>
        <div id="nav-dashboard" class="nav-item" onclick="navTo(&#39;dashboard&#39;); toggleMobileMenu();"><i class="fa-solid fa-tower-observation"></i> 통합 관제탑</div>
        <div id="nav-members" class="nav-item" onclick="openMemberModal(); toggleMobileMenu();"><i class="fa-solid fa-users-gear"></i> 팀원 관리</div>
    </div>
    <button onclick="logout()" style="margin-top:auto; background:none; border:none; color:#ef4444; font-weight:bold; cursor:pointer; display:flex; align-items:center; gap:5px;"><i class="fa-solid fa-right-from-bracket"></i> 로그아웃</button>
</div>

<div id="mobile-sidebar-overlay" onclick="toggleMobileMenu()" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.5); z-index:40;"></div>

<div class="main-content" id="app-main" style="display:none;">
    <div class="header">
        <div style="display:flex; align-items:center; gap:15px;">
            <i class="fa-solid fa-bars" id="mobile-menu-btn" style="display:none; cursor:pointer;" onclick="toggleMobileMenu()"></i>
            <h2 id="page-title" style="font-size:18px; font-weight:800; margin:0;">나의 DB 관리</h2>
        </div>
        <div style="display:flex; align-items:center; gap:10px;">
            <div id="meeting-alert-badge" style="display:none;" onclick="showMeetingList()"></div>
            <div style="font-size:12px; color:#64748b; font-weight:bold; background:#f1f5f9; padding:6px 12px; border-radius:20px;">v24.22</div>
        </div>
    </div>

    <div class="page-content" id="view-list">
        <div class="card" style="padding:20px;">
            <div id="list-filter-container" style="display:flex; gap:10px; margin-bottom:15px; flex-wrap:wrap;"></div>
            <div style="display:flex; justify-content:space-between; align-items:center;">
                <div style="font-size:13px; color:#64748b; display:flex; align-items:center; gap:6px;">
                    <i class="fa-solid fa-circle-info" style="color:var(--primary);"></i> 쉐어 받은 DB는 <b>[이름]쉐어</b>로 표시됩니다.
                </div>
                <button class="btn btn-success" onclick="exportToExcel()"><i class="fa-solid fa-file-excel"></i> 엑셀 다운로드</button>
            </div>
        </div>
        <div class="table-container" style="height: calc(100vh - 300px); overflow-y: auto;">
            <table id="main-table">
                <thead id="list-head"></thead>
                <tbody id="list-body"></tbody>
            </table>
            <div id="empty-message" style="display:none; text-align:center; padding:50px; color:#94a3b8;">
                <i class="fa-solid fa-folder-open" style="font-size:40px; margin-bottom:10px; opacity:0.5;"></i><br>데이터가 없습니다.
            </div>
        </div>
    </div>

    <div class="page-content" id="view-analysis" style="display:none;">
        <div id="admin-analysis-filter" style="display:none; margin-bottom:20px; background:white; padding:15px; border-radius:12px; border:1px solid #ddd;">
            <span style="font-weight:bold; color:var(--primary);">🎯 분석 대상 :</span>
            <select id="analysis-target" onchange="renderAnalysisData()" style="padding:8px; border-radius:6px; font-weight:bold;"><option value="all">🏢 회사 전체</option></select>
        </div>
        <div id="admin-yoy-summary" style="display:none; margin-bottom:30px;">
            <div class="section-title" style="font-weight:800; font-size:16px; margin-bottom:15px;">👥 팀원별 실적 요약</div>
            <div class="table-container"><table id="yoy-summary-table"><thead><tr><th>순위</th><th>이름</th><th>작년 매출</th><th>올해 매출</th><th>성장액</th><th>달성률</th></tr></thead><tbody></tbody></table></div>
        </div>
        <div class="section-title" style="font-weight:800; font-size:16px; margin-bottom:15px;">📊 전년 vs 금년 실적 비교</div>
        <div class="compare-row">
            <div class="compare-box"><div class="compare-val" style="color:#64748b;" id="val-last-total">0</div><div style="font-size:12px; color:#94a3b8;">작년 총 매출</div></div>
            <div class="compare-box" style="background:#eff6ff; border-color:#bfdbfe;"><div class="compare-val" style="color:var(--primary);" id="val-this-total">0</div><div style="font-size:12px; color:var(--primary);">올해 총 매출</div></div>
            <div class="compare-box"><div class="compare-val" id="val-growth">0</div><div style="font-size:12px; color:#64748b;">전년 대비 성장</div></div>
        </div>
        <div class="card"><h4>📅 월별 매출 추이 (YoY)</h4><div class="table-container"><table id="yoy-detail-table"><thead><tr><th>구분</th><th>1월</th><th>2월</th><th>3월</th><th>4월</th><th>5월</th><th>6월</th><th>7월</th><th>8월</th><th>9월</th><th>10월</th><th>11월</th><th>12월</th><th>합계</th></tr></thead><tbody id="yoy-detail-body"></tbody></table></div></div>
        <div class="card"><h4>📋 월별 DB 출처별 성과 (건수 / 금액)</h4><div class="table-container"><table id="month-kpi-table"><thead><tr><th>구분</th><th>1월</th><th>2월</th><th>3월</th><th>4월</th><th>5월</th><th>6월</th><th>7월</th><th>8월</th><th>9월</th><th>10월</th><th>11월</th><th>12월</th><th>합계</th></tr></thead><tbody id="month-kpi-body"></tbody></table></div></div>
    </div>

    <div class="page-content" id="view-history" style="display:none;">
        <div class="card" style="display:flex; align-items:center; gap:15px; background:#f8fafc; border:1px solid #e2e8f0;">
            <h3 style="margin:0; font-size:16px;">📅 조회 기간 :</h3>
            <select id="hist-year" style="padding:8px; border-radius:6px;"><option value="2026">전체 연도</option><option value="2027">2027년</option><option value="2026" selected="">2026년</option><option value="2025">2025년</option><option value="2024">2024년</option><option value="2023">2023년</option></select>
            <select id="hist-month" style="padding:8px; border-radius:6px;"><option value="all">전체 (1년치)</option><option></option><option value="1">1월</option><option value="2">2월</option><option value="3">3월</option><option value="4">4월</option><option value="5">5월</option><option value="6">6월</option><option value="7">7월</option><option value="8">8월</option><option value="9">9월</option><option value="10">10월</option><option value="11">11월</option><option value="12">12월</option></select>
            <button class="btn btn-primary" onclick="renderHistory()">조회하기</button>
        </div>
        <div style="display:flex; gap:10px; margin-bottom:15px;" id="history-tabs"></div>
        <div class="table-container"><table><thead id="history-head"></thead><tbody id="history-body"></tbody></table></div>
    </div>

    <div class="page-content" id="view-dashboard" style="display:none;">
        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px;">
            <h3 style="margin:0; font-weight:800;"><i class="fa-solid fa-tower-observation"></i> 통합 관제탑 (Control Tower)</h3>
            <select id="admin-stat-month" style="padding:8px; border-radius:6px; font-weight:bold;" onchange="renderAdminDashboard()"><option value="1" selected="">전체 월</option><option value="1">1월</option><option value="2">2월</option><option value="3">3월</option><option value="4">4월</option><option value="5">5월</option><option value="6">6월</option><option value="7">7월</option><option value="8">8월</option><option value="9">9월</option><option value="10">10월</option><option value="11">11월</option><option value="12">12월</option></select>
        </div>
        <div class="dashboard-grid">
            <div class="stat-card"><div class="stat-label">이번달 총 매출 (전사)</div><div class="stat-value" id="ad-total-rev">0</div></div>
            <div class="stat-card" style="border-left-color:#10b981;"><div class="stat-label">이번달 총 계약</div><div class="stat-value" id="ad-total-cont">0건</div></div>
            <div class="stat-card" style="border-left-color:#f59e0b;"><div class="stat-label">이번달 신규 DB 유입</div><div class="stat-value" id="ad-total-db">0개</div></div>
            <div class="stat-card" style="border-left-color:#8b5cf6;"><div class="stat-label">전체 계약 전환율</div><div class="stat-value" id="ad-conv-rate">0%</div></div>
        </div>
        <h3 style="margin-bottom:15px;">🏆 이달의 명예의 전당 (실적 달성)</h3>
        <div style="display:flex; gap:20px; margin-bottom:30px;">
            <div class="rank-card" style="border-top:4px solid #f59e0b;"><div class="rank-title" style="color:#b45309;"><i class="fa-solid fa-trophy"></i> 500만원 이상</div><ul class="rank-list" id="rank-500"></ul></div>
            <div class="rank-card" style="border-top:4px solid #10b981;"><div class="rank-title" style="color:#047857;"><i class="fa-solid fa-medal"></i> 300만원 이상</div><ul class="rank-list" id="rank-300"></ul></div>
            <div class="rank-card" style="border-top:4px solid #3b82f6;"><div class="rank-title" style="color:#1d4ed8;"><i class="fa-solid fa-thumbs-up"></i> 60만원 이상</div><ul class="rank-list" id="rank-60"></ul></div>
        </div>
        <h4 style="margin-bottom:15px;">👥 팀원별 종합 성과 현황표</h4>
        <div class="card"><div class="table-container"><table><thead><tr><th>순위</th><th>팀원명</th><th>DB배정</th><th>미팅진행</th><th>가망고객</th><th>계약건수</th><th>전환율</th><th>총 매출액</th><th>상태</th></tr></thead><tbody id="team-status-body"></tbody></table></div></div>
    </div>
</div>

<!-- 팀원 관리 모달 -->
<div class="modal-overlay" id="member-modal">
    <div class="modal-window">
        <div class="modal-header">
            <h3><i class="fa-solid fa-users-gear"></i> 팀원 관리</h3>
            <button onclick="closeMemberModal()" style="border:none; background:none; font-size:24px; cursor:pointer; color:#64748b;">×</button>
        </div>
        <div class="modal-body">
            <div style="font-size:13px; color:#64748b; margin-bottom:15px; background:#f8fafc; padding:12px; border-radius:8px;">
                <i class="fa-solid fa-info-circle" style="color:var(--primary);"></i> 팀원 추가 시 초기 비밀번호는 <b>1234</b>입니다.
            </div>
            <div id="member-list-container" style="border:1px solid #e2e8f0; border-radius:8px; max-height:400px; overflow-y:auto;"></div>
            <div class="add-member-row">
                <input type="text" id="new-member-name" placeholder="새 팀원 이름 입력">
                <button class="btn btn-primary" onclick="addTeamMember()"><i class="fa-solid fa-plus"></i> 추가</button>
            </div>
        </div>
    </div>
</div>

<div class="modal-overlay" id="modal">
    <div class="modal-window">
        <div class="modal-header"><h3>📝 DB 정보 상세</h3><button onclick="closeModal()" style="border:none; background:none; font-size:24px; cursor:pointer; color:#64748b;">×</button></div>
        <div class="modal-body">
            <div class="panel-left">
                <input type="hidden" id="edit-id">
                <div class="card" style="margin:0 0 20px 0; border-left:4px solid var(--primary);">
                    <div class="section-label" style="color:var(--primary); font-weight:800; margin-bottom:10px;">1단계: 업체 기본정보</div>
                    <div style="background:#f8fafc; padding:12px; margin-bottom:15px; border-radius:8px; font-size:14px; border:1px solid #e2e8f0; display:flex; gap:10px;">
                        <span style="color:#64748b;">담당자:</span> <span id="display-member" style="color:#1e293b; font-weight:bold;"></span>
                    </div>
                    <div class="form-grid">
                        <div class="form-group"><label>접수일</label><input type="date" id="input-date" onclick="this.showPicker()"></div>
                        <div class="form-group"><label>DB 출처</label><select id="input-source" onchange="updateShareFields(); toggleGradeField(); calculateShare();"><option value="회사DB">🏢 회사 DB</option><option value="개인DB">👤 개인 DB</option><option value="팀DB">👥 팀 DB</option><option value="기타DB">🎸 기타 DB</option></select></div>
                        <div class="form-group" id="group-grade-prov"><label>제공 등급 (회사DB 전용)</label><select id="input-grade-prov"><option value="A">A</option><option value="B">B</option><option value="C">C</option><option value="D">D</option></select></div>
                        <div class="form-group"><label>업체명 <span style="color:red">*</span></label><input type="text" id="input-company" placeholder="필수 입력"></div>
                        <div class="form-group"><label>대표자</label><input type="text" id="input-ceo" placeholder="예: 홍길동"></div>
                        <div class="form-group"><label>연락처</label><input type="text" id="input-phone"></div>
                        <div class="form-group"><label>업종</label><select id="input-industry"><option value="">선택</option><option value="제조">제조</option><option value="건설">건설</option><option value="도소매">도소매</option><option value="서비스">서비스</option><option value="IT">IT</option><option value="음식점">음식점</option><option value="기타">기타</option></select></div>
                        <div class="form-group"><label>매출 규모</label><select id="input-revenue"><option value="미확인">미확인</option><option value="1억미만">1억 미만</option><option value="1억~3억">1억 ~ 3억</option><option value="3억이상">3억 이상</option><option value="5억이상">5억 이상</option><option value="10억이상">10억 이상</option><option value="30억이상">30억 이상</option></select></div>
                    </div>
                </div>
                <div class="card" style="margin:0 0 20px 0; border-left:4px solid #f59e0b;">
                    <div class="section-label" style="color:#b45309; font-weight:800; margin-bottom:10px;">2단계: 전화 검증</div>
                    <div class="form-grid">
                        <div class="form-group"><label>대표 신용점수</label><select id="input-credit"><option value="">미확인</option><option value="900이상">900점 이상</option><option value="800이상">800점 이상</option><option value="700이상">700점 이상</option><option value="700미만">700점 미만</option><option value="사고이력">사고 이력</option></select></div>
                        <div class="form-group"><label>연매출 (백만원)</label><input type="text" id="input-annual-rev" onkeyup="formatCurrency(this)" placeholder="예: 1,000"></div>
                        <div class="form-group"><label>세금 체납여부</label><select id="input-tax"><option value="완납">완납</option><option value="분납중">분납중</option><option value="연체중">연체중</option><option value="기타">기타</option></select></div>
                        <div class="form-group"><label>지역</label><select id="input-region"><option value="">선택</option><option value="서울">서울</option><option value="경기">경기</option><option value="인천">인천</option><option value="부산">부산</option><option value="대구">대구</option><option value="광주">광주</option><option value="대전">대전</option><option value="울산">울산</option><option value="세종">세종</option><option value="강원">강원</option><option value="충북">충북</option><option value="충남">충남</option><option value="전북">전북</option><option value="전남">전남</option><option value="경북">경북</option><option value="경남">경남</option><option value="제주">제주</option></select></div>
                        <div class="form-group"><label>미팅 일정</label><input type="date" id="input-meet-date" onclick="this.showPicker()"></div>
                    </div>
                </div>
                <div class="card" style="margin:0; border-left:4px solid #10b981;">
                    <div class="section-label" style="color:#047857; font-weight:800; margin-bottom:10px;">3단계: 진행 및 계약</div>
                    <div class="form-group"><label>현재 상태</label><select id="input-status" style="padding:12px; font-weight:bold;" onchange="toggleStatusFields()"><option value="대기">⏳ 대기</option><option value="진행중">🏃 진행중</option><option value="가망고객">🌟 가망고객</option><option value="계약">🎉 계약</option><option value="종료">❌ 종료</option></select></div>
                    <div id="box-wait" class="dynamic-section"><div class="form-group"><label style="color:#64748b;">대기 사유</label><input type="text" id="input-wait-reason" placeholder="대기 사유를 입력하세요."></div></div>
                    <div id="box-ing" class="dynamic-section"><div class="form-group"><label style="color:#2563eb;">진행 과정 상세</label><textarea id="input-ing-detail" rows="3" placeholder="진행 상황을 상세히 기록하세요."></textarea></div></div>
                    <div id="box-prospect" class="dynamic-section prospect-box"><div class="form-group"><label style="color:#7c3aed;">🌟 가망고객 선정 사유 및 포인트</label><textarea id="input-prospect-detail" rows="3" placeholder="핵심 포인트와 예상 계약 시점"></textarea></div></div>
                    <div id="box-end" class="dynamic-section"><div class="form-group"><label style="color:#ef4444;">종료/거절 사유</label><input type="text" id="input-end-reason" placeholder="종료 사유를 입력하세요."></div></div>
                    <div id="box-contract" class="dynamic-section contract-box">
                        <div class="form-grid">
                            <div class="form-group"><label>계약 상품</label><input type="text" id="input-product" placeholder="예) 교보경정"></div>
                            <div class="form-group"><label>계약 금액 (원)</label><input type="text" id="input-amount" onkeyup="formatCurrency(this); calculateShare();" placeholder="콤마 자동"></div>
                        </div>
                        <div class="share-info" id="share-calculator">
                            <div style="font-weight:bold; margin-bottom:10px; display:flex; justify-content:space-between; align-items:center;"><span>📊 쉐어 계산기</span><span style="font-size:11px; color:#ef4444;">* 쉐어받는 팀장만 입력 (내실적은 자동계산)</span></div>
                            <div class="share-row"><span style="font-size:11px; font-weight:bold; width:20px;">1</span><select id="share-partner-1" onchange="calculateShare()"><option value="">선택</option></select><input type="number" id="share-percent-1" placeholder="%" oninput="calculateShare()"> % <span class="share-val" id="share-val-1">0</span></div>
                            <div class="share-row"><span style="font-size:11px; font-weight:bold; width:20px;">2</span><select id="share-partner-2" onchange="calculateShare()"><option value="">선택</option></select><input type="number" id="share-percent-2" placeholder="%" oninput="calculateShare()"> % <span class="share-val" id="share-val-2">0</span></div>
                            <div class="share-row"><span style="font-size:11px; font-weight:bold; width:20px;">3</span><select id="share-partner-3" onchange="calculateShare()"><option value="">선택</option></select><input type="number" id="share-percent-3" placeholder="%" oninput="calculateShare()"> % <span class="share-val" id="share-val-3">0</span></div>
                            <div style="margin-top:15px; padding-top:10px; border-top:1px dashed #e2e8f0; display:flex; justify-content:space-between; font-weight:bold;"><span>총액: <span id="disp-total">0</span></span><span style="color:blue;">내 실적: <span id="disp-net">0</span></span></div>
                        </div>
                    </div>
                    <div id="btn-roadmap-area" style="display:none; margin-top:20px;"><button class="btn btn-dark" style="width:100%; padding:15px; font-size:15px;" onclick="openRoadmapPopup()"><i class="fa-solid fa-diagram-project"></i> 📅 컨설팅 로드맵 관리 (새창 열기)</button></div>
                    <div class="form-group" style="margin-top:15px;"><label>상담내용 및 컨설팅 방향 기재</label><textarea id="input-consulting" rows="3"></textarea></div>
                </div>
            </div>
            <div class="panel-right">
                <h4 style="display:flex; align-items:center; gap:8px;"><i class="fa-regular fa-clock"></i> 활동 로그</h4>
                <div style="font-size:12px; color:#64748b; margin-bottom:10px; background:#f1f5f9; padding:12px; border-radius:8px; line-height:1.5;">
                    날짜 기록이 필요한 모든 이슈를 실시간 기록으로 남겨 놓길 바랍니다<br>예) ~차 부재중, 미팅후 진행 사항 등등
                </div>
                <div style="display:flex; gap:5px; margin-bottom:10px;"><input type="text" id="hist-input" placeholder="내용 입력" style="flex:1;" onkeypress="if(event.keyCode==13) addLog()"><button onclick="addLog()" class="btn btn-primary">등록</button></div>
                <div id="log-list" style="flex:1; overflow-y:auto; border-top:1px solid #eee; padding-top:10px;"></div>
                <div style="margin-top:auto; display:flex; gap:5px;"><button onclick="saveData()" class="btn btn-primary" style="flex:1;">저장</button><button onclick="deleteData()" class="btn btn-danger">삭제</button></div>
            </div>
        </div>
    </div>
</div>

<div class="modal-overlay" id="roadmap-modal"><div class="modal-window"><div class="modal-header"><h3><i class="fa-solid fa-diagram-project"></i> 컨설팅 로드맵 워크스페이스</h3><button onclick="closeRoadmapPopup()" style="border:none; background:none; font-size:24px; cursor:pointer;">×</button></div><div class="modal-body" style="background:#fff;"><div class="roadmap-toolbar" id="rm-toolbar"><div style="font-weight:800; margin-bottom:10px; color:#1e293b; display:flex; align-items:center; gap:5px;"><i class="fa-solid fa-hand-pointer"></i> 빠른 항목 추가</div><div class="roadmap-presets" id="rm-presets"></div><div class="rm-input-row" id="rm-input-box"><div class="rm-input-group" style="flex:2;"><span class="rm-input-label">항목명</span><input type="text" id="rm-name" placeholder="항목 선택" style="padding:10px; border:1px solid #cbd5e1; border-radius:6px; font-weight:bold;"></div><div class="rm-input-group" style="flex:1;"><span class="rm-input-label">시작</span><select id="rm-start" style="padding:10px; border:1px solid #cbd5e1; border-radius:6px;"></select></div><div class="rm-input-group" style="flex:1;"><span class="rm-input-label">종료</span><select id="rm-end" style="padding:10px; border:1px solid #cbd5e1; border-radius:6px;"></select></div><div class="rm-input-group" style="flex:1;"><span class="rm-input-label">정렬</span><select id="rm-align" style="padding:10px; border:1px solid #cbd5e1; border-radius:6px;"><option value="center">가운데</option><option value="left">좌측</option><option value="right">우측</option><option value="out">바깥</option></select></div><div class="rm-input-group" style="flex:3;"><span class="rm-input-label">설명 (// 줄바꿈)</span><input type="text" id="rm-desc" placeholder="내용" style="padding:10px; border:1px solid #cbd5e1; border-radius:6px;"></div><div style="display:flex; flex-direction:column; gap:5px; margin-top:auto;"><button class="btn btn-primary" id="btn-add-rm" style="height:42px;" onclick="addManualRoadmap()"><i class="fa-solid fa-plus"></i> 추가</button><button class="btn btn-secondary" id="btn-cancel-rm" style="height:30px; font-size:12px; display:none;" onclick="resetRoadmapInput()">취소</button></div></div></div><div id="rm-list" style="margin-bottom:15px; font-size:13px; color:#666; min-height:30px; padding:10px; border:1px dashed #cbd5e1; border-radius:8px;"></div><div class="rm-container"><div id="roadmap-print-area"><div contenteditable="true" id="print-company-name" class="rm-title-edit" spellcheck="false">Project Schedule</div><div style="font-size:14px; color:#64748b; font-weight:normal; margin-bottom:20px; text-align:right;" id="print-member-name"></div><div style="overflow-x:auto;"><table class="rm-table"><thead><tr id="rm-header-row-1"><th class="rm-header" style="width:120px;" rowspan="2">항목</th></tr><tr id="rm-header-row-2"></tr></thead><tbody id="rm-body"></tbody></table></div></div></div><div style="margin-top:auto; display:flex; justify-content:flex-end; gap:10px; padding-top:20px; border-top:1px solid #eee;"><button class="btn btn-primary" style="padding:15px 30px; font-size:16px;" onclick="saveRoadmap()">저장 후 닫기</button><button class="btn btn-dark" style="padding:15px 30px; font-size:16px;" onclick="printRoadmap()"><i class="fa-solid fa-print"></i> 로드맵 인쇄</button></div></div></div></div>

<script>
    const GAS_URL = 'https://script.google.com/macros/s/AKfycbx3BhJhRdcrZsYcEKbQwA6HSCziWhdY7gbux82bh2xdjFHZi6BFxlvhcl7er8oW2VaXGg/exec'; 
    
    function sha256(ascii) {
        function rightRotate(value, amount) { return (value>>>amount) | (value<<(32 - amount)); }
        var mathPow = Math.pow; var maxWord = mathPow(2, 32); var lengthProperty = 'length'; var i, j; var result = '';
        var words = []; var asciiBitLength = ascii[lengthProperty]*8; var hash = [0x6a09e667, 0xbb67ae85, 0x3c6ef372, 0xa54ff53a, 0x510e527f, 0x9b05688c, 0x1f83d9ab, 0x5be0cd19];
        var k = [0x428a2f98, 0x71374491, 0xb5c0fbcf, 0xe9b5dba5, 0x3956c25b, 0x59f111f1, 0x923f82a4, 0xab1c5ed5, 0xd807aa98, 0x12835b01, 0x243185be, 0x550c7dc3, 0x72be5d74, 0x80deb1fe, 0x9bdc06a7, 0xc19bf174, 0xe49b69c1, 0xefbe4786, 0x0fc19dc6, 0x240ca1cc, 0x2de92c6f, 0x4a7484aa, 0x5cb0a9dc, 0x76f988da, 0x983e5152, 0xa831c66d, 0xb00327c8, 0xbf597fc7, 0xc6e00bf3, 0xd5a79147, 0x06ca6351, 0x14292967, 0x27b70a85, 0x2e1b2138, 0x4d2c6dfc, 0x53380d13, 0x650a7354, 0x766a0abb, 0x81c2c92e, 0x92722c85, 0xa2bfe8a1, 0xa81a664b, 0xc24b8b70, 0xc76c51a3, 0xd192e819, 0xd6990624, 0xf40e3585, 0x106aa070, 0x19a4c116, 0x1e376c08, 0x2748774c, 0x34b0bcb5, 0x391c0cb3, 0x4ed8aa4a, 0x5b9cca4f, 0x682e6ff3, 0x748f82ee, 0x78a5636f, 0x84c87814, 0x8cc70208, 0x90befffa, 0xa4506ceb, 0xbef9a3f7, 0xc67178f2];
        ascii += '\x80'; while (ascii[lengthProperty]%64 - 56) ascii += '\x00'; 
        for (i = 0; i < ascii[lengthProperty]; i++) { j = ascii.charCodeAt(i); if (j>>8) return; words[i>>2] |= j << ((3 - i)%4)*8; }
        words[words[lengthProperty]] = ((asciiBitLength/maxWord)|0); words[words[lengthProperty]] = (asciiBitLength);
        for (j = 0; j < words[lengthProperty];) {
            var w = words.slice(j, j += 16); var oldHash = hash; hash = hash.slice(0, 8);
            for (i = 0; i < 64; i++) {
                var i2 = i + j; var w15 = w[i - 15], w2 = w[i - 2];
                var a = hash[0], e = hash[4];
                var temp1 = hash[7] + (rightRotate(e, 6) ^ rightRotate(e, 11) ^ rightRotate(e, 25)) + ((e&hash[5])^((~e)&hash[6])) + k[i] + (w[i] = (i < 16) ? w[i] : (w[i - 16] + (rightRotate(w15, 7) ^ rightRotate(w15, 18) ^ (w15>>>3)) + w[i - 7] + (rightRotate(w2, 17) ^ rightRotate(w2, 19) ^ (w2>>>10)))|0);
                var temp2 = (rightRotate(a, 2) ^ rightRotate(a, 13) ^ rightRotate(a, 22)) + ((a&hash[1])^(a&hash[2])^(hash[1]&hash[2]));
                hash = [(temp1 + temp2)|0].concat(hash); hash[4] = (hash[4] + temp1)|0;
            }
            for (i = 0; i < 8; i++) { hash[i] = (hash[i] + oldHash[i])|0; }
        }
        for (i = 0; i < 8; i++) { for (j = 3; j + 1; j--) { var b = (hash[i]>>(j*8))&255; result += ((b < 16) ? 0 : '') + b.toString(16); } }
        return result;
    }

    let members = []; 
    let dbList = [];
    let currentUser = null;
    let tempLogs = [];
    let currentId = null;
    let historyTab = 'prospect';
    let isAdminLogAdded = false; 
    let tempRoadmap = []; 
    let editIndex = -1;
    let dragSrcEl = null; let dragSrcIndex = null;
    let isDragging = false; 
    const roadmapItems = ["신보", "기보", "신용보증재단", "소진공", "중진공", "법인설립(전환)", "특허", "벤처인증", "연구전담부서설립", "재무등급관리"];
    const colorPalette = ['#0f172a', '#1e3a8a', '#1d4ed8', '#3b82f6', '#60a5fa', '#93c5fd'];

    window.onload = function() {
        fetchDB(() => {
            const lastId = localStorage.getItem('last_login_id');
            const lastPw = localStorage.getItem('last_login_pw'); 
            if(lastId && lastPw) {
                document.getElementById('login-user-name').value = lastId;
                document.getElementById('login-remember').checked = true;
                const user = members.find(m => m.name === lastId);
                if(user && user.pw === lastPw) processLoginSuccess(user);
            }
        });
        initDateSelects(); 
    };

    function showLoading() { document.getElementById('loading-overlay').style.display = 'flex'; }
    function hideLoading() { document.getElementById('loading-overlay').style.display = 'none'; }
    function showToast(msg, type='success') {
        const c = document.getElementById('toast-container');
        const t = document.createElement('div');
        t.className = `toast ${type}`;
        t.innerHTML = `<i class="fa-solid ${type==='success'?'fa-circle-check':'fa-circle-exclamation'}" style="color:${type==='success'?'var(--success)':'var(--danger)'}"></i> ${msg}`;
        c.appendChild(t);
        setTimeout(() => { t.style.animation='fadeOut 0.3s forwards'; setTimeout(()=>t.remove(),300); }, 3000);
    }

    function toggleMobileMenu() {
        if(window.innerWidth > 768) return;
        const sidebar = document.getElementById('app-sidebar');
        const overlay = document.getElementById('mobile-sidebar-overlay');
        if (sidebar.classList.contains('active')) { sidebar.classList.remove('active'); overlay.style.display = 'none'; } 
        else { sidebar.classList.add('active'); overlay.style.display = 'block'; }
    }

    function parseDBDate(dateStr) {
        if(!dateStr) return { year: 0, month: 0 };
        try {
            let dateObj = new Date(dateStr);
            if(!isNaN(dateObj.getTime())) {
                return { year: dateObj.getFullYear(), month: dateObj.getMonth() + 1 };
            }
            const parts = dateStr.match(/(\d{4})[\.\-\/]\s?(\d{1,2})[\.\-\/]\s?(\d{1,2})/);
            if(parts) return { year: parseInt(parts[1]), month: parseInt(parts[2]) };
        } catch(e) {}
        return { year: 0, month: 0 };
    }

    // 미팅 알림 체크 함수
    function checkMeetingAlerts() {
        if(!currentUser) return;
        const today = new Date();
        today.setHours(0,0,0,0);
        
        const myDB = currentUser.role === 'admin' ? dbList : dbList.filter(d => d.member === currentUser.name);
        let todayCount = 0;
        let upcomingCount = 0;
        let overdueCount = 0;
        let meetingDetails = [];
        
        myDB.forEach(d => {
            if(!d.meetDate || d.status === '계약' || d.status === '종료') return;
            const meetDate = new Date(d.meetDate);
            meetDate.setHours(0,0,0,0);
            const diffDays = Math.ceil((meetDate - today) / (1000 * 60 * 60 * 24));
            
            if(diffDays === 0) {
                todayCount++;
                meetingDetails.push({ company: d.company, type: 'today', date: d.meetDate, id: d.id });
            } else if(diffDays > 0 && diffDays <= 3) {
                upcomingCount++;
                meetingDetails.push({ company: d.company, type: 'upcoming', date: d.meetDate, days: diffDays, id: d.id });
            } else if(diffDays < 0 && diffDays >= -7) {
                overdueCount++;
                meetingDetails.push({ company: d.company, type: 'overdue', date: d.meetDate, days: Math.abs(diffDays), id: d.id });
            }
        });
        
        const badge = document.getElementById('meeting-alert-badge');
        badge.dataset.details = JSON.stringify(meetingDetails);
        
        if(todayCount > 0) {
            badge.innerHTML = `<span class="meeting-badge meeting-today"><i class="fa-solid fa-bell"></i> 오늘 미팅 ${todayCount}건</span>`;
            badge.style.display = 'block';
        } else if(overdueCount > 0) {
            badge.innerHTML = `<span class="meeting-badge meeting-overdue"><i class="fa-solid fa-exclamation-triangle"></i> 지난 미팅 ${overdueCount}건</span>`;
            badge.style.display = 'block';
        } else if(upcomingCount > 0) {
            badge.innerHTML = `<span class="meeting-badge meeting-upcoming"><i class="fa-solid fa-calendar"></i> 예정 미팅 ${upcomingCount}건</span>`;
            badge.style.display = 'block';
        } else {
            badge.style.display = 'none';
        }
    }

    // 미팅 목록 표시
    function showMeetingList() {
        const badge = document.getElementById('meeting-alert-badge');
        const details = JSON.parse(badge.dataset.details || '[]');
        if(details.length === 0) return;
        
        let msg = '📅 미팅 일정 알림\n\n';
        details.forEach(m => {
            if(m.type === 'today') msg += `🔴 오늘: ${m.company}\n`;
            else if(m.type === 'upcoming') msg += `🔵 ${m.days}일 후: ${m.company} (${m.date})\n`;
            else if(m.type === 'overdue') msg += `⚠️ ${m.days}일 전: ${m.company} (${m.date})\n`;
        });
        
        alert(msg);
    }

    function fetchDB(callback) {
        if(!GAS_URL || GAS_URL.includes('URL을_붙여넣으세요')) return showToast('URL 설정 필요', 'error');
        document.getElementById('login-loading').style.display = 'block';
        fetch(GAS_URL).then(res => res.json()).then(data => {
            document.getElementById('login-loading').style.display = 'none';
            if (data.db) dbList = data.db; else dbList = [];
            if (data.members) members = data.members;
            dbList.sort((a, b) => {
                const dateA = new Date(a.date).getTime() || 0;
                const dateB = new Date(b.date).getTime() || 0;
                if (dateB !== dateA) return dateB - dateA;
                return (Number(b.id)||0) - (Number(a.id)||0);
            });
            if(callback) callback();
            checkMeetingAlerts();
        }).catch(err => {
            document.getElementById('login-loading').style.display = 'none';
            console.error(err);
            showToast('서버 연결 실패', 'error');
        });
    }

    function attemptLogin(type) {
        const inputName = document.getElementById('login-user-name').value.trim();
        const inputPw = document.getElementById('login-pw').value;
        if(!inputName) return showToast("이름을 입력하세요.", 'error');
        if(!inputPw) return showToast("비밀번호를 입력하세요.", 'error');
        const user = members.find(m => m.name === inputName);
        if (!user) return showToast("등록되지 않은 사용자입니다.", 'error');
        const hashedInput = sha256(inputPw); 
        if (user.pw !== hashedInput) return showToast("비밀번호가 틀렸습니다.", 'error');
        if (type === 'admin' && user.role !== 'admin') return showToast("관리자 권한이 없습니다.", 'error');
        processLoginSuccess(user);
    }

    function processLoginSuccess(user) {
        currentUser = user;
        const isRemember = document.getElementById('login-remember').checked;
        if(isRemember) {
            localStorage.setItem('last_login_id', user.name);
            localStorage.setItem('last_login_pw', user.pw);
        } else {
            localStorage.removeItem('last_login_id');
            localStorage.removeItem('last_login_pw');
        }
        document.getElementById('login-screen').style.display='none';
        document.getElementById('app-sidebar').style.display='flex';
        document.getElementById('app-main').style.display='flex';
        document.getElementById('profile-name').innerText = user.name;
        document.getElementById('profile-role').innerText = user.role === 'admin' ? 'Admin Master' : 'Team Leader';
        
        if(user.role === 'admin') {
            document.getElementById('app-sidebar').classList.add('admin-mode');
            document.getElementById('admin-menu').style.display='block';
            document.getElementById('admin-yoy-summary').style.display='block';
            document.getElementById('page-title').innerText = '팀원 DB 관리';
        } else {
            document.getElementById('app-sidebar').classList.remove('admin-mode');
            document.getElementById('admin-menu').style.display='none';
            document.getElementById('admin-yoy-summary').style.display='none';
            document.getElementById('page-title').innerText = '나의 DB 관리';
        }
        setupHistoryTabs(); 
        checkMeetingAlerts();
        navTo('list');
    }

    // 팀원 관리 모달
    function openMemberModal() {
        document.getElementById('member-modal').style.display = 'flex';
        renderMemberList();
    }

    function closeMemberModal() {
        document.getElementById('member-modal').style.display = 'none';
        document.getElementById('new-member-name').value = '';
    }

    function renderMemberList() {
        const container = document.getElementById('member-list-container');
        container.innerHTML = '';
        
        members.forEach(m => {
            if(m.name === '관리자') return;
            const isAdmin = m.role === 'admin';
            container.innerHTML += `
                <div class="member-list-item">
                    <div>
                        <span class="member-name">${m.name}</span>
                        <span class="member-role">${isAdmin ? '(관리자)' : '(팀원)'}</span>
                    </div>
                    <div class="member-actions">
                        <button class="btn-icon btn-icon-danger" onclick="deleteTeamMember('${m.name}')" title="삭제">
                            <i class="fa-solid fa-trash"></i>
                        </button>
                    </div>
                </div>
            `;
        });
        
        if(members.filter(m => m.name !== '관리자').length === 0) {
            container.innerHTML = '<div style="padding:20px; text-align:center; color:#94a3b8;">등록된 팀원이 없습니다.</div>';
        }
    }

    function addTeamMember() {
        const nameInput = document.getElementById('new-member-name');
        const newName = nameInput.value.trim();
        if(!newName) return showToast("팀원 이름을 입력하세요.", 'error');
        
        showLoading();
        fetch(GAS_URL, { method: 'POST', body: JSON.stringify({ action: 'add_member', name: newName, pw: '1234' }) })
        .then(res => res.json()).then(data => {
            hideLoading();
            if(data.result === 'success') { 
                showToast("팀원이 추가되었습니다."); 
                nameInput.value = '';
                fetchDB(() => renderMemberList());
            } 
            else if(data.result === 'duplicate') { showToast("이미 존재하는 이름입니다.", 'error'); } 
            else { showToast("오류 발생", 'error'); }
        }).catch(err => {
            hideLoading();
            showToast("서버 오류", 'error');
        });
    }

    function deleteTeamMember(targetName) {
        if(targetName === '관리자') return showToast("관리자는 삭제할 수 없습니다.", 'error');
        if(!confirm(`정말 '${targetName}' 팀원을 삭제하시겠습니까?\n해당 팀원의 모든 DB 데이터는 보존되지만 로그인은 불가능해집니다.`)) return;
        
        showLoading();
        fetch(GAS_URL, { method: 'POST', body: JSON.stringify({ action: 'del_member', name: targetName }) })
        .then(res => res.json()).then(data => {
            hideLoading();
            if(data.result === 'success') { 
                showToast("삭제되었습니다."); 
                fetchDB(() => renderMemberList()); 
            } else { 
                showToast("존재하지 않는 팀원입니다.", 'error'); 
            }
        }).catch(err => {
            hideLoading();
            showToast("서버 오류", 'error');
        });
    }

    function exportToExcel() {
        const table = document.getElementById('main-table');
        const wb = XLSX.utils.table_to_book(table, {sheet: "DB_List"});
        const dateStr = new Date().toISOString().split('T')[0]; 
        XLSX.writeFile(wb, `DB_List_${dateStr}.xlsx`);
    }

    function changePassword() {
        const newPw = prompt("새로운 비밀번호를 입력하세요:");
        if(!newPw) return;
        if(newPw.length < 4) return showToast("비밀번호는 4자 이상이어야 합니다.", 'error');
        showLoading();
        fetch(GAS_URL, { method: 'POST', body: JSON.stringify({ action: 'change_pw', name: currentUser.name, newPw: newPw }) })
        .then(res => res.json()).then(data => {
            hideLoading();
            if(data.result === 'success') {
                showToast("변경되었습니다. 다음 로그인부터 적용됩니다.");
                const hashedNewPw = sha256(newPw);
                if(localStorage.getItem('last_login_id') === currentUser.name) localStorage.setItem('last_login_pw', hashedNewPw);
                currentUser.pw = hashedNewPw;
            } else { showToast("변경 실패", 'error'); }
        });
    }

    function toggleGradeField() { 
        document.getElementById('group-grade-prov').style.display = (document.getElementById('input-source').value === '회사DB') ? 'block' : 'none'; 
    }

    function toggleStatusFields() {
        const s = document.getElementById('input-status').value;
        document.querySelectorAll('.dynamic-section').forEach(el=>el.classList.remove('active'));
        if(s==='대기') document.getElementById('box-wait').classList.add('active');
        if(s==='진행중') document.getElementById('box-ing').classList.add('active');
        if(s==='가망고객') document.getElementById('box-prospect').classList.add('active');
        if(s==='계약') { document.getElementById('box-contract').classList.add('active'); calculateShare(); }
        if(s==='종료') document.getElementById('box-end').classList.add('active');
        const showRoadmap = (s === '진행중' || s === '계약');
        document.getElementById('btn-roadmap-area').style.display = showRoadmap ? 'block' : 'none';
    }

    function updateShareFields() {
        const source = document.getElementById('input-source').value;
        const currentMember = document.getElementById('display-member').innerText;
        const selectors = [1,2,3].map(i => document.getElementById(`share-partner-${i}`));
        const inputs = [1,2,3].map(i => document.getElementById(`share-percent-${i}`));
        
        let commonOptions = `<option value="">선택</option>`;
        members.forEach(m => { 
            if(m.role !== 'admin' && m.name !== currentMember) {
                commonOptions += `<option value="${m.name}">${m.name} 팀장</option>`; 
            }
        });
        
        selectors.forEach((sel, idx) => {
            const currentVal = sel.value; 
            let finalOptions = commonOptions;
            
            if(source === '회사DB' && idx === 0) {
                finalOptions = `<option value="회사">🏢 회사</option>`;
            } else if(source === '팀DB' && idx === 0) {
                finalOptions = `<option value="SM">🗣️ SM</option>`;
            } else if(source === '회사DB') {
                finalOptions = `<option value="">선택</option><option value="회사">🏢 회사</option>` + commonOptions.replace('<option value="">선택</option>','');
            } else if(source === '팀DB') {
                finalOptions = `<option value="">선택</option><option value="SM">🗣️ SM</option>` + commonOptions.replace('<option value="">선택</option>','');
            }
            
            sel.innerHTML = finalOptions;
            sel.value = currentVal;
        });
        
        if(source === '회사DB') { 
            selectors[0].value = '회사'; selectors[0].disabled = true; 
            inputs[0].value = 10; inputs[0].readOnly = true; 
        } else if(source === '팀DB') { 
            selectors[0].value = 'SM'; selectors[0].disabled = true; 
            inputs[0].value = 30; inputs[0].readOnly = true; 
        } else { 
            selectors[0].disabled = false; 
            inputs[0].readOnly = false; 
        }
    }

    function calculateShare() {
        const totalRaw = document.getElementById('input-amount').value.replace(/,/g,'');
        const total = totalRaw === '' ? 0 : (parseInt(totalRaw) || 0);
        let totalDeduction = 0; 
        
        for(let i=1; i<=3; i++) {
            const partnerSel = document.getElementById(`share-partner-${i}`);
            const percentIn = document.getElementById(`share-percent-${i}`);
            const valSpan = document.getElementById(`share-val-${i}`);
            const source = document.getElementById('input-source').value;
            
            if(i===1) {
                if(source==='회사DB') { percentIn.value=10; partnerSel.value='회사'; }
                if(source==='팀DB') { percentIn.value=30; partnerSel.value='SM'; }
            }
            
            const pct = parseInt(percentIn.value) || 0;
            let shareAmt = 0;
            if(pct > 0 && partnerSel.value) { 
                shareAmt = Math.floor(total * (pct / 100)); 
            }
            valSpan.innerText = shareAmt.toLocaleString();
            valSpan.style.color = shareAmt > 0 ? '#ef4444' : '#ccc';
            totalDeduction += shareAmt;
        }
        
        document.getElementById('disp-total').innerText = total.toLocaleString();
        document.getElementById('disp-net').innerText = (total - totalDeduction).toLocaleString();
    }

    // 로드맵 인쇄 함수 (완벽 복구)
    function printRoadmap() {
        const printArea = document.getElementById('roadmap-print-area');
        const printWindow = window.open('', '_blank', 'width=1200,height=800');
        
        // 현재 문서의 스타일 가져오기
        const styleContent = `
            * { box-sizing: border-box; margin: 0; padding: 0; }
            body { 
                font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, system-ui, Roboto, sans-serif; 
                margin: 30px; 
                background: white;
                -webkit-print-color-adjust: exact !important;
                print-color-adjust: exact !important;
            }
            .rm-title-edit {
                font-size: 32px;
                font-weight: 900;
                text-align: center;
                margin-bottom: 40px;
                color: #1e293b;
                border: none !important;
                background: transparent !important;
            }
            .rm-table { 
                width: 100%; 
                border-collapse: collapse; 
                table-layout: fixed; 
                font-size: 12px; 
            }
            .rm-header { 
                background: #1e3a8a !important; 
                color: white !important; 
                padding: 12px 0; 
                border: 1px solid #94a3b8; 
                font-weight: bold; 
                text-align: center; 
            }
            .rm-subheader { 
                background: #3b82f6 !important; 
                color: white !important; 
                padding: 6px 0; 
                border: 1px solid #94a3b8; 
                font-size: 11px; 
                text-align: center; 
            }
            .rm-cell { 
                border: 1px solid #cbd5e1; 
                height: 55px; 
                position: relative; 
                background: white; 
            }
            .rm-cat-col { 
                width: 120px; 
                text-align: center; 
                font-weight: 800; 
                border: 1px solid #94a3b8; 
                color: white !important; 
                padding: 5px; 
                word-break: keep-all; 
                vertical-align: middle; 
            }
            .rm-diagonal { 
                background: linear-gradient(to top right, #f1f5f9 49.5%, #94a3b8 50%, #f1f5f9 50.5%) !important; 
                position: relative; 
            }
            .rm-diagonal-text { 
                position: absolute; 
                font-size: 11px; 
                font-weight: bold; 
                color: #334155; 
            }
            .rm-text-bottom-left { bottom: 5px; left: 8px; }
            .rm-text-top-right { top: 5px; right: 8px; }
            .rm-bar-container { 
                position: absolute; 
                top: 10px; 
                bottom: 10px; 
                border-radius: 15px; 
                display: flex; 
                align-items: center; 
                color: white; 
                font-size: 12px; 
                font-weight: bold; 
                box-shadow: 2px 3px 6px rgba(0,0,0,0.15); 
                overflow: hidden; 
                z-index: 10; 
                white-space: nowrap; 
            }
            .rm-align-left { justify-content: flex-start; padding-left: 10px; }
            .rm-align-center { justify-content: center; }
            .rm-align-right { justify-content: flex-end; padding-right: 10px; }
            .rm-bar-outer-text { 
                position: absolute; 
                top: 50%; 
                transform: translateY(-50%); 
                left: 105%; 
                margin-left: 8px; 
                font-size: 11px; 
                font-weight: bold; 
                color: #334155; 
                z-index: 5; 
                white-space: nowrap; 
            }
            /* 색상 클래스 */
            .bg-0f172a { background-color: #0f172a !important; }
            .bg-1e3a8a { background-color: #1e3a8a !important; }
            .bg-1d4ed8 { background-color: #1d4ed8 !important; }
            .bg-3b82f6 { background-color: #3b82f6 !important; }
            .bg-60a5fa { background-color: #60a5fa !important; }
            .bg-93c5fd { background-color: #93c5fd !important; color: #1e293b !important; }
            @media print {
                body { margin: 0; }
                * { -webkit-print-color-adjust: exact !important; print-color-adjust: exact !important; }
            }
        `;

        printWindow.document.write(`
            <!DOCTYPE html>
            <html>
            <head>
                <meta charset="UTF-8">
                <title>컨설팅 로드맵</title>
                <style>${styleContent}</style>
            </head>
            <body>
                ${printArea.innerHTML}
            </body>
            </html>
        `);
        
        printWindow.document.close();
        
        // 인쇄 실행
        setTimeout(() => {
            printWindow.focus();
            printWindow.print();
        }, 500);
    }
    
    function openRoadmapPopup() {
        document.getElementById('roadmap-modal').style.display = 'flex';
        resetRoadmapInput();
        const comp = document.getElementById('input-company').value.trim();
        document.getElementById('print-company-name').innerText = comp ? comp + " Project Schedule" : "Project Schedule"; 
        const mem = document.getElementById('display-member').innerText || "담당자";
        document.getElementById('print-member-name').innerText = `오너스경영연구소 - ${mem} 팀장`;
        renderRoadmapView(); 
    }
    function closeRoadmapPopup() { document.getElementById('roadmap-modal').style.display = 'none'; }
    function saveRoadmap() { showToast('로드맵이 저장되었습니다.'); closeRoadmapPopup(); }
    function initRoadmapInputs() {
        const startSel = document.getElementById('rm-start'); 
        const endSel = document.getElementById('rm-end');
        const presetDiv = document.getElementById('rm-presets'); 
        presetDiv.innerHTML = '';
        roadmapItems.forEach(item => { presetDiv.innerHTML += `<button class="btn-preset" onclick="setPresetName('${item}')">${item}</button>`; });
        startSel.innerHTML = ''; endSel.innerHTML = '';
        const baseYear = new Date().getFullYear(); 
        for(let y=0; y<5; y++) { for(let m=1; m<=12; m++) { const val = (y*12) + m; const label = `${baseYear+y}년 ${m}월`; startSel.innerHTML += `<option value="${val}">${label}</option>`; endSel.innerHTML += `<option value="${val}">${label}</option>`; } }
    }
    function setPresetName(name) { const input = document.getElementById('rm-name'); input.value = name; input.focus(); document.querySelectorAll('.btn-preset').forEach(btn => btn.classList.remove('active')); event.target.classList.add('active'); }
    function resetRoadmapInput() {
        initRoadmapInputs();
        document.getElementById('rm-name').value = ''; document.getElementById('rm-start').value = 1; document.getElementById('rm-end').value = 1; document.getElementById('rm-desc').value = ''; document.getElementById('rm-align').value = 'center';
        editIndex = -1; document.getElementById('btn-add-rm').innerHTML = '<i class="fa-solid fa-plus"></i> 추가'; document.getElementById('btn-add-rm').classList.replace('btn-dark','btn-primary'); document.getElementById('btn-cancel-rm').style.display = 'none'; document.getElementById('rm-input-box').classList.remove('edit-mode'); renderRoadmapView();
    }
    function addManualRoadmap() {
        const name = document.getElementById('rm-name').value; const start = parseInt(document.getElementById('rm-start').value); const end = parseInt(document.getElementById('rm-end').value); const desc = document.getElementById('rm-desc').value; const align = document.getElementById('rm-align').value; 
        if(!name) return showToast("항목명을 입력하세요", 'error'); if(end < start) return showToast("종료 시점 오류", 'error');
        const duration = end - start + 1; const newItem = { name: name, start: start, duration: duration, desc: desc, align: align };
        if(editIndex > -1) tempRoadmap[editIndex] = newItem; else tempRoadmap.push(newItem);
        resetRoadmapInput(); 
    }
    function loadRoadmapItemForEdit(idx) {
        if(isDragging) return;
        if(!confirm("수정하시겠습니까?")) return;
        const item = tempRoadmap[idx];
        document.getElementById('rm-name').value = item.name; document.getElementById('rm-start').value = item.start; document.getElementById('rm-end').value = item.start + item.duration - 1; document.getElementById('rm-desc').value = item.desc || ''; document.getElementById('rm-align').value = item.align || 'center'; 
        editIndex = idx; document.getElementById('btn-add-rm').innerHTML = '<i class="fa-solid fa-check"></i> 수정 저장'; document.getElementById('btn-add-rm').classList.replace('btn-primary','btn-dark'); document.getElementById('btn-cancel-rm').style.display = 'block'; document.getElementById('rm-input-box').classList.add('edit-mode'); document.getElementById('rm-name').focus();
    }
    function removeRoadmapItem(idx) { if(confirm("삭제하시겠습니까?")) { tempRoadmap.splice(idx, 1); if(editIndex===idx) resetRoadmapInput(); else if(editIndex>idx) editIndex--; renderRoadmapView(); } }
    function handleDragStart(e, idx) { isDragging = true; dragSrcIndex = idx; dragSrcEl = e.target; e.target.classList.add('dragging'); e.dataTransfer.effectAllowed = 'move'; }
    function handleDragOver(e) { if(e.preventDefault) e.preventDefault(); e.dataTransfer.dropEffect = 'move'; const t=e.target.closest('.rm-item-chip'); if(t&&t!==dragSrcEl) { document.querySelectorAll('.rm-item-chip').forEach(el=>el.classList.remove('drag-over')); t.classList.add('drag-over'); } return false; }
    function handleDragLeave(e) { const t=e.target.closest('.rm-item-chip'); if(t) t.classList.remove('drag-over'); }
    function handleDrop(e, dropIndex) { if(e.stopPropagation) e.stopPropagation(); if(dragSrcIndex!==dropIndex) { const item=tempRoadmap[dragSrcIndex]; tempRoadmap.splice(dragSrcIndex,1); tempRoadmap.splice(dropIndex,0,item); resetRoadmapInput(); renderRoadmapView(); } return false; }
    function handleDragEnd(e) { document.querySelectorAll('.rm-item-chip').forEach(el=>{el.classList.remove('dragging'); el.classList.remove('drag-over');}); setTimeout(() => { isDragging = false; }, 100); }
    
    function renderRoadmapView() {
        const tbody = document.getElementById('rm-body'); 
        const listDiv = document.getElementById('rm-list'); 
        const h1 = document.getElementById('rm-header-row-1'); 
        const h2 = document.getElementById('rm-header-row-2');
        tbody.innerHTML=''; 
        listDiv.innerHTML='';
        
        let maxMonth=12; 
        tempRoadmap.forEach(i=>{ if(i.start+i.duration-1>maxMonth) maxMonth=i.start+i.duration-1; });
        const years=Math.ceil(maxMonth/12); 
        const baseYear=new Date().getFullYear();
        
        let hh1=`<th class="rm-header rm-diagonal" style="width:120px;" rowspan="2"><span class="rm-diagonal-text rm-text-bottom-left">항목</span><span class="rm-diagonal-text rm-text-top-right">일정</span></th>`;
        let hh2=''; 
        for(let y=0; y<years; y++) { 
            hh1+=`<th class="rm-header" colspan="12">${baseYear+y}</th>`; 
            for(let m=1; m<=12; m++) hh2+=`<th class="rm-subheader">${m}</th>`; 
        }
        h1.innerHTML=hh1; 
        h2.innerHTML=hh2;
        
        if(tempRoadmap.length===0) listDiv.innerHTML='<div style="text-align:center;color:#94a3b8;font-size:12px;">항목 없음</div>';
        else tempRoadmap.forEach((item,idx)=>{
            const chip=document.createElement('div'); 
            chip.className='rm-item-chip'; 
            chip.draggable=true;
            chip.innerHTML=`<i class="fa-solid fa-grip-vertical" style="color:#94a3b8;margin-right:5px;"></i><span style="font-weight:bold;color:#334155;">${item.name}</span><i class="fa-solid fa-xmark" style="color:#ef4444;margin-left:8px;cursor:pointer;"></i>`;
            chip.addEventListener('dragstart',e=>handleDragStart(e,idx)); 
            chip.addEventListener('dragover',handleDragOver); 
            chip.addEventListener('dragleave',handleDragLeave); 
            chip.addEventListener('drop',e=>handleDrop(e,idx)); 
            chip.addEventListener('dragend',handleDragEnd);
            chip.onclick=()=>loadRoadmapItemForEdit(idx); 
            chip.querySelector('.fa-xmark').onclick=e=>{e.stopPropagation(); removeRoadmapItem(idx);};
            listDiv.appendChild(chip);
        });
        
        if(tempRoadmap.length===0) { 
            tbody.innerHTML=`<tr><td colspan="${1+(years*12)}" style="text-align:center;padding:20px;color:#cbd5e1;">비어있음</td></tr>`; 
            return; 
        }
        
        tempRoadmap.forEach((item,idx)=>{
            let tr='<tr>'; 
            const cHex=colorPalette[Math.min(idx,5)]; 
            const tCol=(Math.min(idx,5)>=5)?'#1e293b':'white';
            const bgClass = `bg-${cHex.replace('#','')}`;
            
            tr+=`<td class="rm-cat-col ${bgClass}" onclick="loadRoadmapItemForEdit(${idx})" style="background:${cHex};border-color:${cHex};color:${tCol};cursor:pointer;">${item.name}</td>`;
            const cols=years*12;
            
            for(let i=1; i<=cols; i++) {
                if(i===item.start) {
                    const desc=item.desc?item.desc.replace(/\/\//g,'<br>'):''; 
                    const align=item.align||'center';
                    let cont=''; 
                    if(align==='out') {
                        cont=`<div class="rm-bar-container ${bgClass}" style="width:100%;background:${cHex};"></div><div class="rm-bar-outer-text">${desc}</div>`;
                    } else {
                        cont=`<div class="rm-bar-container rm-align-${align} ${bgClass}" style="width:100%;background:${cHex};color:${tCol};"><span class="rm-bar-desc">${desc}</span></div>`;
                    }
                    tr+=`<td class="rm-cell" colspan="${item.duration}" style="border-right:none;z-index:1;overflow:visible;" onclick="loadRoadmapItemForEdit(${idx})">${cont}</td>`;
                    i+=(item.duration-1);
                } else {
                    tr+='<td class="rm-cell"></td>';
                }
            }
            tr+='</tr>'; 
            tbody.innerHTML+=tr;
        });
    }

    function renderFilters() {
        const container = document.getElementById('list-filter-container');
        if(!container) return; 
        if(currentUser.role === 'admin') {
            let html = `
                <select id="filter-year" style="padding:10px; border:1px solid #ddd; border-radius:8px;" onchange="renderList()"></select>
                <select id="filter-month" style="padding:10px; border:1px solid #ddd; border-radius:8px;" onchange="renderList()"></select>
                <select id="filter-source" style="padding:10px; border:1px solid #ddd; border-radius:8px;" onchange="renderList()"><option value="all">전체 출처</option><option value="회사DB">회사 DB</option><option value="개인DB">개인 DB</option><option value="팀DB">팀 DB</option><option value="쉐어받음">쉐어 받음 (전체)</option></select>
                <select id="filter-status" style="padding:10px; border:1px solid #ddd; border-radius:8px;" onchange="renderList()"><option value="all">전체 상태</option><option value="대기">⏳ 대기</option><option value="진행중">🏃 진행중</option><option value="가망고객">🌟 가망고객</option><option value="계약">🎉 계약</option><option value="종료">❌ 종료</option></select>
                <select id="filter-member" style="padding:10px; border:1px solid #2563eb; color:#2563eb; font-weight:bold; border-radius:8px;" onchange="renderList()"><option value="all">전체 팀원 보기</option></select>
            `;
            container.innerHTML = html;
            const memSel = document.getElementById('filter-member');
            members.forEach(m => { if(m.role !== 'admin') memSel.innerHTML += `<option value="${m.name}">${m.name}</option>`; });
        } else {
            let html = `
                <input type="text" id="search-keyword" placeholder="업체명 검색" style="flex:1; padding:10px; border:1px solid #ddd; border-radius:8px;" onkeyup="renderList()">
                <select id="filter-year" style="padding:10px; border:1px solid #ddd; border-radius:8px;" onchange="renderList()"></select>
                <select id="filter-month" style="padding:10px; border:1px solid #ddd; border-radius:8px;" onchange="renderList()"></select>
                <select id="filter-source" style="padding:10px; border:1px solid #ddd; border-radius:8px;" onchange="renderList()"><option value="all">전체 출처</option><option value="회사DB">회사 DB</option><option value="개인DB">개인 DB</option><option value="팀DB">팀 DB</option><option value="쉐어받음">쉐어 받음 (전체)</option></select>
            `;
            container.innerHTML = html;
        }
        initDateSelects(); 
    }
    
    function initDateSelects() {
        const yearSel = document.getElementById('filter-year');
        const monthSel = document.getElementById('filter-month');
        const histYearSel = document.getElementById('hist-year');
        const histMonthSel = document.getElementById('hist-month');
        const adminMonthSel = document.getElementById('admin-stat-month');
        
        const currentYear = new Date().getFullYear();
        const currentMonth = new Date().getMonth() + 1;
        
        let opts = `<option value="all">전체 연도</option>`;
        for(let y = currentYear + 1; y >= 2023; y--) opts += `<option value="${y}" ${y===currentYear?'selected':''}>${y}년</option>`;
        if(yearSel) yearSel.innerHTML = opts;
        if(histYearSel) histYearSel.innerHTML = opts.replace('value="all"', 'value="'+currentYear+'"');
        
        let mOpts = `<option value="all">전체 월</option>`;
        for(let m=1; m<=12; m++) mOpts += `<option value="${m}">${m}월</option>`;
        if(monthSel) monthSel.innerHTML = mOpts;
        if(histMonthSel) histMonthSel.innerHTML = `<option value="all">전체 (1년치)</option>` + mOpts.replace('value="all"','').replace('전체 월','');
        if(adminMonthSel) adminMonthSel.innerHTML = mOpts.replace('value="all"', `value="${currentMonth}" selected`);
    }

    function setupHistoryTabs() {
        const tabsDiv = document.getElementById('history-tabs');
        if(!tabsDiv) return;
        
        const btnClass = (tab) => `btn ${historyTab===tab ? 'btn-primary' : 'btn-secondary'}`;
        
        if(currentUser.role === 'admin') {
            tabsDiv.innerHTML = `
                <button class="${btnClass('admin-prospect')}" onclick="switchHistoryTab('admin-prospect')">🌟 가망고객</button>
                <button class="${btnClass('contract')}" onclick="switchHistoryTab('contract')">🤝 계약 고객</button>
            `;
        } else {
            tabsDiv.innerHTML = `
                <button class="${btnClass('prospect')}" onclick="switchHistoryTab('prospect')">🌟 가망고객</button>
                <button class="${btnClass('contract')}" onclick="switchHistoryTab('contract')">🤝 계약 고객</button>
            `;
        }
    }

    function switchHistoryTab(t) {
        historyTab = t;
        setupHistoryTabs(); 
        renderHistory();
    }

    function navTo(page) {
        if(page === 'dashboard' && currentUser.role !== 'admin') return showToast("관리자 권한 필요", 'error');
        document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));
        const map = { 'list': 'nav-list', 'analysis': 'nav-analysis', 'history': 'nav-history', 'dashboard': 'nav-dashboard' };
        if(document.getElementById(map[page])) document.getElementById(map[page]).classList.add('active');
        document.querySelectorAll('.page-content').forEach(el => el.style.display = 'none');
        document.getElementById('view-' + page).style.display = 'block';

        if(page === 'list') { 
            renderFilters(); 
            if(currentUser.role==='admin') document.getElementById('list-head').innerHTML=`<tr><th>접수일</th><th>담당자</th><th>미팅일</th><th>출처</th><th>업체명</th><th>지역</th><th>상태</th></tr>`; 
            else document.getElementById('list-head').innerHTML=`<tr><th>접수일</th><th>미팅일</th><th>출처</th><th>업체명</th><th>업종</th><th>지역</th><th>상태</th></tr>`; 
            renderList(); 
        }
        if(page === 'analysis') renderAnalysisData();
        if(page === 'dashboard') renderAdminDashboard();
        if(page === 'history') { setupHistoryTabs(); renderHistory(); } 
    }

    function renderList() {
        const tbody = document.getElementById('list-body'); if(!tbody) return;
        const yearEl = document.getElementById('filter-year');
        const monthEl = document.getElementById('filter-month');
        const sourceEl = document.getElementById('filter-source');
        if(!yearEl || !monthEl || !sourceEl) return;
        tbody.innerHTML = '';
        const year = yearEl.value; const month = monthEl.value; const source = sourceEl.value;
        let kw = ''; let statusFilter = 'all'; let targetMem = currentUser.name;
        if(currentUser.role === 'admin') {
            const statusEl = document.getElementById('filter-status');
            const memberEl = document.getElementById('filter-member');
            if(statusEl) statusFilter = statusEl.value;
            if(memberEl) targetMem = memberEl.value; else targetMem = 'all'; 
        } else {
            const searchEl = document.getElementById('search-keyword');
            kw = searchEl ? searchEl.value.toLowerCase() : '';
        }
        let filtered = dbList.filter(d => {
            if (!d) return false; 
            const { year: dYear, month: dMonth } = parseDBDate(d.date); 
            if(year !== 'all' && dYear != year) return false;
            if(month !== 'all' && dMonth != month) return false;
            const dSource = d.source || ""; 
            if(source === '쉐어받음') { if(!dSource.includes('쉐어')) return false; } else if(source !== 'all' && dSource !== source) { return false; }
            if(currentUser.role === 'admin') {
                if(statusFilter !== 'all' && d.status !== statusFilter) return false;
                if(targetMem !== 'all' && d.member !== targetMem) return false;
            } else {
                if(d.member !== currentUser.name) return false;
                const dComp = (d.company || "").toLowerCase();
                if(kw && !dComp.includes(kw)) return false;
            }
            return true;
        });
        filtered.sort((a, b) => {
            const cleanDate = (str) => { if (!str) return 0; const parts = str.match(/(\d{4})[\.\-\/]\s?(\d{1,2})[\.\-\/]\s?(\d{1,2})/); if (parts) return new Date(`${parts[1]}-${parts[2]}-${parts[3]}`).getTime(); return new Date(str).getTime(); };
            const dateA = cleanDate(a.date) || 0; const dateB = cleanDate(b.date) || 0;
            if (dateB !== dateA) return dateB - dateA; else return (Number(b.id)||0) - (Number(a.id)||0);
        });
        
        if(filtered.length === 0) {
            document.getElementById('empty-message').style.display = 'block';
        } else {
            document.getElementById('empty-message').style.display = 'none';
            filtered.forEach(d => {
                let badge = 'status-wait';
                if(d.status === '진행중') badge = 'status-ing';
                if(d.status === '가망고객') badge = 'status-prospect';
                if(d.status === '계약') badge = 'status-done';
                if(d.status === '종료') badge = 'status-end';
                if((d.source || "").includes('쉐어')) badge = 'status-share';
                let alertIcon = '';
                if(currentUser.role !== 'admin' && d.hasAdminAlert) alertIcon = ` <i class="fa-solid fa-bell" style="color:#ef4444; margin-left:5px;" title="관리자 코멘트"></i>`;
                let row = `<td>${d.date}</td>`;
                if(currentUser.role === 'admin') row += `<td>${d.member}</td>`;
                row += `<td style="color:${d.meetDate?'#2563eb':'#cbd5e1'}">${d.meetDate || '-'}</td><td>${d.source}</td><td style="font-weight:bold">${d.company}${alertIcon}</td>${currentUser.role !== 'admin' ? `<td>${d.industry||'-'}</td>` : ''} <td>${d.region || '-'}</td><td><span class="badge ${badge}">${d.status}</span></td>`;
                tbody.innerHTML += `<tr onclick="openModal('${d.id}')">${row}</tr>`;
            });
        }
    }

    function renderAnalysisData() { renderYoYSummaryTable(); renderYoYDetail(); renderMonthlyKPI(); }
    
    function renderYoYSummaryTable() { 
        const tbody = document.querySelector('#yoy-summary-table tbody'); tbody.innerHTML = ''; 
        const thisY = new Date().getFullYear(); 
        let list = members.filter(m=>m.role!=='admin').map(m => { 
            const myDB = dbList.filter(d=>d.member===m.name && d.status==='계약'); 
            const l = myDB.filter(d => parseDBDate(d.date).year === thisY-1).reduce((a,c)=>a+(parseInt(String(c.amount).replace(/,/g,''))||0),0); 
            const t = myDB.filter(d => parseDBDate(d.date).year === thisY).reduce((a,c)=>a+(parseInt(String(c.amount).replace(/,/g,''))||0),0); 
            return {name:m.name, last:l, this:t}; 
        }).sort((a,b)=>b.this-a.this); 
        list.forEach((d,i)=>{ 
            tbody.innerHTML+=`<tr><td>${i+1}</td><td>${d.name}</td><td>${d.last.toLocaleString()}</td><td>${d.this.toLocaleString()}</td><td>${(d.this-d.last).toLocaleString()}</td><td>${d.last>0?Math.round((d.this-d.last)/d.last*100):0}%</td></tr>`; 
        }); 
    }
    
    function renderYoYDetail() { 
        const thisY = new Date().getFullYear(); const lastY = thisY - 1; 
        const thisData = Array(12).fill(0); const lastData = Array(12).fill(0); 
        let targetDB = (currentUser.role === 'admin') ? dbList : dbList.filter(d => d.member === currentUser.name); 
        targetDB.forEach(d => { 
            if(d.status !== '계약') return; 
            const { year, month } = parseDBDate(d.date);
            const amt = parseInt(String(d.amount).replace(/,/g,'')) || 0;
            if(year === thisY) thisData[month-1] += amt; 
            if(year === lastY) lastData[month-1] += amt; 
        }); 
        const thisTotal = thisData.reduce((a,b)=>a+b,0); const lastTotal = lastData.reduce((a,b)=>a+b,0); 
        document.getElementById('val-last-total').innerText = lastTotal.toLocaleString(); 
        document.getElementById('val-this-total').innerText = thisTotal.toLocaleString(); 
        document.getElementById('val-growth').innerText = (thisTotal - lastTotal).toLocaleString(); 
        let html = `<tr><td>${lastY}년</td>`; lastData.forEach(v => html += `<td>${v.toLocaleString()}</td>`); html += `<td style="font-weight:bold">${lastTotal.toLocaleString()}</td></tr>`; 
        html += `<tr style="background:#eff6ff"><td>${thisY}년</td>`; thisData.forEach(v => html += `<td>${v.toLocaleString()}</td>`); html += `<td style="font-weight:bold; color:blue">${thisTotal.toLocaleString()}</td></tr>`; 
        document.getElementById('yoy-detail-body').innerHTML = html; 
    }
    
    function renderMonthlyKPI() { 
        const ty = new Date().getFullYear(); 
        let d = (currentUser.role === 'admin') ? dbList : dbList.filter(x => x.member === currentUser.name); 
        d = d.filter(x => parseDBDate(x.date).year === ty && x.status === '계약'); 
        const sources = ['회사DB', '개인DB', '팀DB', '기타DB', '쉐어받음']; 
        const data = {}; sources.forEach(s => { data[s] = Array(12).fill().map(() => ({ cnt: 0, amt: 0 })); }); 
        d.forEach(x => { 
            const { month } = parseDBDate(x.date);
            let src = x.source || ""; 
            if(src.includes('쉐어')) src = '쉐어받음'; else if(!sources.includes(src)) src = '기타DB'; 
            if(data[src]) { 
                data[src][month-1].cnt++; 
                data[src][month-1].amt += (parseInt(String(x.amount).replace(/,/g,'')) || 0); 
            } 
        }); 
        const tb = document.getElementById('month-kpi-table').querySelector('tbody'); tb.innerHTML = ''; 
        sources.forEach(src => { 
            let rowHtml = `<td style="font-weight:bold">${src}</td>`; 
            let totalCnt = 0; let totalAmt = 0; 
            for(let i=0; i<12; i++) { 
                const c = data[src][i].cnt; const a = data[src][i].amt; totalCnt += c; totalAmt += a; 
                rowHtml += `<td>${c > 0 ? `<b>${c}</b><br><span style="font-size:10px; color:#2563eb">${a.toLocaleString()}</span>` : '<span style="color:#eee">-</span>'}</td>`; 
            } 
            rowHtml += `<td style="background:#f1f5f9; font-weight:bold;">${totalCnt}건<br><span style="color:#2563eb">${totalAmt.toLocaleString()}</span></td>`; 
            tb.innerHTML += `<tr>${rowHtml}</tr>`; 
        }); 
    }

    function renderHistory() { 
        const y = document.getElementById('hist-year').value; const m = document.getElementById('hist-month').value; 
        const tbody = document.getElementById('history-body'); const thead = document.getElementById('history-head'); 
        tbody.innerHTML = ''; 
        
        let cols = '';
        if(historyTab === 'admin-prospect' || historyTab === 'prospect') cols = `<tr><th>접수일</th><th>담당자</th><th>업체명</th><th>DB출처</th><th>현재상태</th></tr>`;
        else cols = `<tr><th>계약일</th><th>담당자</th><th>업체명</th><th>상품</th><th>매출(순수익)</th></tr>`;
        thead.innerHTML = cols;

        const list = dbList.filter(d => { 
            const { year: dYear, month: dMonth } = parseDBDate(d.date);
            if(y !== 'all' && dYear != y) return false; 
            if(m !== 'all' && dMonth != m) return false; 
            
            if(currentUser.role !== 'admin' && d.member !== currentUser.name) return false;

            if(historyTab === 'admin-prospect' || historyTab === 'prospect') {
                return d.status === '가망고객';
            } else {
                return d.status === '계약';
            }
        }); 
        
        if(list.length === 0) { tbody.innerHTML = '<tr><td colspan="5" style="text-align:center; padding:30px;">기록 내용 없음</td></tr>'; return; } 
        
        list.forEach(d => { 
            let row = ''; 
            if(historyTab === 'admin-prospect' || historyTab === 'prospect') {
                row = `<td>${d.date}</td><td>${d.member}</td><td style="font-weight:bold">${d.company}</td><td style="color:blue">${d.source}</td><td><span class="badge status-prospect">${d.status}</span></td>`;
            } else {
                row = `<td>${d.date}</td><td>${d.member}</td><td style="font-weight:bold">${d.company}</td><td>${d.product||'-'}</td><td style="color:blue">${(d.amount||0).toLocaleString()}</td>`; 
            }
            tbody.innerHTML += `<tr onclick="openModal('${d.id}')">${row}</tr>`; 
        }); 
    }

    function renderAdminDashboard() { 
        const now = new Date(); 
        const selectedMonth = document.getElementById('admin-stat-month').value; 
        const targetYear = now.getFullYear(); 
        const targetMonth = (selectedMonth === 'all') ? (now.getMonth() + 1) : parseInt(selectedMonth); 
        
        const monthlyData = dbList.filter(d => { 
            const { year, month } = parseDBDate(d.date);
            return year === targetYear && month === targetMonth; 
        }); 
        
        const totalDB = monthlyData.length; 
        const contracts = monthlyData.filter(d => d.status === '계약'); 
        const totalRevenue = contracts.reduce((acc, curr) => acc + (parseInt(String(curr.amount).replace(/,/g,''))||0), 0); 
        const convRate = totalDB > 0 ? ((contracts.length / totalDB) * 100).toFixed(1) : 0; 
        
        document.getElementById('ad-total-rev').innerText = totalRevenue.toLocaleString() + "원"; 
        document.getElementById('ad-total-cont').innerText = contracts.length + "건"; 
        document.getElementById('ad-total-db').innerText = totalDB + "개"; 
        document.getElementById('ad-conv-rate').innerText = convRate + "%"; 
        
        const stats = {}; 
        contracts.forEach(d => { 
            if(!stats[d.member]) stats[d.member] = 0; 
            stats[d.member] += (parseInt(String(d.amount).replace(/,/g,'')) || 0); 
        }); 
        
        const sorted = Object.entries(stats).sort((a,b) => b[1] - a[1]); 
        const r500 = sorted.filter(x => x[1] >= 5000000); 
        const r300 = sorted.filter(x => x[1] >= 3000000 && x[1] < 5000000); 
        const r60 = sorted.filter(x => x[1] >= 600000 && x[1] < 3000000); 
        
        function fillList(id, arr) { 
            const el = document.getElementById(id); el.innerHTML = ''; 
            if(arr.length === 0) el.innerHTML = '<li style="padding:10px; color:#999; text-align:center;">달성자 없음</li>'; 
            arr.forEach(x => { el.innerHTML += `<li class="rank-item"><span>${x[0]}</span> <span class="rank-val">${x[1].toLocaleString()}</span></li>`; }); 
        } 
        fillList('rank-500', r500); fillList('rank-300', r300); fillList('rank-60', r60); 
        
        const tbody = document.getElementById('team-status-body'); tbody.innerHTML = ''; 
        const teamStats = members.filter(m => m.role !== 'admin').map(m => { 
            const myData = monthlyData.filter(d => d.member === m.name); 
            const dbCount = myData.length; 
            const meetCount = myData.reduce((acc,curr) => acc + (curr.logs ? curr.logs.length : 0), 0); 
            const prospectCount = myData.filter(d => d.status === '가망고객').length; 
            const contCount = myData.filter(d => d.status === '계약').length; 
            const rev = myData.filter(d => d.status === '계약').reduce((a,c) => a + (parseInt(String(c.amount).replace(/,/g,''))||0), 0); 
            const rate = dbCount > 0 ? Math.round((contCount/dbCount)*100) : 0; 
            return { name: m.name, db: dbCount, meet: meetCount, prospect: prospectCount, cont: contCount, rev: rev, rate: rate }; 
        }).sort((a,b) => b.rev - a.rev); 
        
        teamStats.forEach((s, idx) => { 
            const maxRev = teamStats[0].rev || 1; 
            const barWidth = Math.max(5, (s.rev / maxRev) * 100); 
            tbody.innerHTML += `<tr style="height:50px;"><td style="font-weight:bold;">${idx+1}</td><td>${s.name}</td><td>${s.db}</td><td>${s.meet}</td><td style="color:var(--prospect); font-weight:bold;">${s.prospect}</td><td style="color:#10b981; font-weight:bold;">${s.cont}</td><td>${s.rate}%</td><td><div style="font-weight:bold; color:var(--primary);">${s.rev.toLocaleString()}</div><div class="progress-bar-bg"><div class="progress-bar-fill" style="width:${barWidth}%"></div></div></td><td>${s.rev >= 5000000 ? '🔥' : '-'}</td></tr>`; 
        }); 
    }

    function formatCurrency(input) { 
        const val = input.value.replace(/,/g, '');
        if(!val) { input.value = ''; return; }
        const num = parseInt(val);
        if(isNaN(num)) { input.value = ''; return; }
        input.value = num.toLocaleString(); 
    }

    function openModal(id) {
        document.getElementById('modal').style.display='flex'; currentId=id||null; isAdminLogAdded=false; const consult=document.getElementById('input-consulting');
        if(currentId) {
            const d=dbList.find(x=>x.id==id); if(currentUser.role!=='admin'&&d.hasAdminAlert) { d.hasAdminAlert=false; renderList(); }
            document.getElementById('edit-id').value=d.id; document.getElementById('display-member').innerText=d.member;
            document.getElementById('input-date').value=d.date; document.getElementById('input-source').value=d.source; document.getElementById('input-grade-prov').value=d.gradeProv||'A';
            document.getElementById('input-company').value=d.company; document.getElementById('input-ceo').value=d.ceo||''; document.getElementById('input-phone').value=d.phone||'';
            document.getElementById('input-industry').value=d.industry||''; document.getElementById('input-revenue').value=d.revenue||'mi'; document.getElementById('input-credit').value=d.credit||'';
            document.getElementById('input-annual-rev').value=d.annualRev?d.annualRev.toLocaleString():''; document.getElementById('input-tax').value=d.tax||'완납'; document.getElementById('input-region').value=d.region||'';
            document.getElementById('input-meet-date').value=d.meetDate||''; document.getElementById('input-status').value=d.status;
            document.getElementById('input-wait-reason').value=d.waitReason||''; document.getElementById('input-ing-detail').value=d.ingDetail||'';
            document.getElementById('input-prospect-detail').value=d.prospectDetail||''; document.getElementById('input-end-reason').value=d.endReason||'';
            document.getElementById('input-product').value=d.product||''; document.getElementById('input-amount').value=d.totalAmount?d.totalAmount.toLocaleString():'';
            consult.value=d.consulting||''; if(d.consultingWidth) consult.style.width=d.consultingWidth+'px'; else consult.style.width='100%'; if(d.consultingHeight) consult.style.height=d.consultingHeight+'px'; else consult.style.height='auto';
            updateShareFields();
            if(d.shareList) d.shareList.forEach((s,i)=>{ if(i<3) { document.getElementById(`share-partner-${i+1}`).value=s.partner; document.getElementById(`share-percent-${i+1}`).value=s.percent; }});
            tempLogs=d.logs||[]; tempRoadmap=d.roadmap||[];
        } else {
            document.getElementById('edit-id').value=''; document.getElementById('display-member').innerText=currentUser.name; document.getElementById('input-date').valueAsDate=new Date();
            document.getElementById('input-source').value='회사DB'; document.getElementById('input-grade-prov').value='A';
            document.getElementById('input-company').value=''; document.getElementById('input-ceo').value=''; document.getElementById('input-phone').value='';
            document.getElementById('input-industry').value=''; document.getElementById('input-revenue').value='미확인'; document.getElementById('input-credit').value='';
            document.getElementById('input-annual-rev').value=''; document.getElementById('input-tax').value='완납'; document.getElementById('input-region').value=''; document.getElementById('input-meet-date').value='';
            document.getElementById('input-status').value='대기'; document.getElementById('input-wait-reason').value=''; document.getElementById('input-ing-detail').value=''; document.getElementById('input-prospect-detail').value=''; document.getElementById('input-end-reason').value='';
            document.getElementById('input-product').value=''; document.getElementById('input-amount').value=''; consult.value=''; consult.style.width='100%'; consult.style.height='auto';
            updateShareFields(); [1,2,3].forEach(i=>{ document.getElementById(`share-partner-${i}`).value=''; document.getElementById(`share-percent-${i}`).value=''; document.getElementById(`share-val-${i}`).innerText='0'; }); calculateShare();
            tempLogs=[]; tempRoadmap=[];
        }
        toggleGradeField(); toggleStatusFields(); renderLogs();
    }
    function closeModal() { document.getElementById('modal').style.display='none'; }
    function logout() { localStorage.removeItem('last_login_id'); localStorage.removeItem('last_login_pw'); location.reload(); }
    function addLog() { const t=document.getElementById('hist-input').value; if(t) { tempLogs.unshift({time:new Date().toLocaleString(), text:t, writer:currentUser.name}); renderLogs(); document.getElementById('hist-input').value=''; if(currentUser.role==='admin') isAdminLogAdded=true; } }
    function renderLogs() { document.getElementById('log-list').innerHTML=tempLogs.map(l=>`<div style="font-size:12px;border-bottom:1px solid #eee;padding:5px;">[${l.time}] <b>${l.writer}</b>: ${l.text}</div>`).join(''); }
    function saveData() {
        if(!GAS_URL) return alert('URL 오류');
        const id=document.getElementById('edit-id').value||Date.now(); const total=parseInt(document.getElementById('input-amount').value.replace(/,/g,''))||0;
        let shareList=[]; let ded=0; for(let i=1;i<=3;i++){ const p=document.getElementById(`share-partner-${i}`).value; const pct=parseInt(document.getElementById(`share-percent-${i}`).value)||0; if(p&&pct>0){ let amt=Math.floor(total*(pct/100)); shareList.push({partner:p,percent:pct,amount:amt,step:i}); ded+=amt; } }
        let ex=dbList.find(x=>x.id==id)||{}; const consult=document.getElementById('input-consulting');
        const obj={
            id:id, member:document.getElementById('display-member').innerText, date:document.getElementById('input-date').value,
            source:document.getElementById('input-source').value, gradeProv:document.getElementById('input-grade-prov').value,
            company:document.getElementById('input-company').value, ceo:document.getElementById('input-ceo').value, phone:document.getElementById('input-phone').value,
            industry:document.getElementById('input-industry').value, revenue:document.getElementById('input-revenue').value, credit:document.getElementById('input-credit').value,
            annualRev:parseInt(document.getElementById('input-annual-rev').value.replace(/,/g,''))||0, tax:document.getElementById('input-tax').value, region:document.getElementById('input-region').value,
            meetDate:document.getElementById('input-meet-date').value, status:document.getElementById('input-status').value,
            waitReason:document.getElementById('input-wait-reason').value, ingDetail:document.getElementById('input-ing-detail').value, prospectDetail:document.getElementById('input-prospect-detail').value, endReason:document.getElementById('input-end-reason').value,
            product:document.getElementById('input-product').value, totalAmount:total, amount:total-ded, shareList:shareList, consulting:consult.value,
            consultingWidth:consult.offsetWidth, consultingHeight:consult.offsetHeight,
            logs:tempLogs, roadmap:tempRoadmap, hasAdminAlert:(currentUser.role==='admin'&&isAdminLogAdded)?true:(ex.hasAdminAlert||false)
        };
        showLoading();
        fetch(GAS_URL, { method:'POST', body:JSON.stringify({action:'save', data:obj}) }).then(r=>r.json()).then(d=>{ hideLoading(); alert('저장 완료'); closeModal(); fetchDB(()=>{ if(currentUser.role==='admin'&&document.getElementById('view-dashboard').style.display==='block') renderAdminDashboard(); else renderList(); checkMeetingAlerts(); }); }).catch(e=>{ hideLoading(); alert('저장 실패'); });
    }
    function deleteData() { if(!confirm('삭제하시겠습니까?')) return; const id=document.getElementById('edit-id').value; showLoading(); fetch(GAS_URL, { method:'POST', body:JSON.stringify({action:'delete', id:id}) }).then(r=>r.json()).then(d=>{ hideLoading(); alert('삭제 완료'); closeModal(); fetchDB(()=>renderList()); }).catch(e=>{ hideLoading(); alert('실패'); }); }
</script>


<div class="" data-v-6275cb=""><!----></div><div id="wp-extension" data-id="dpadflhmiohjfhhaehelneimpllfbpcg"></div></body></html>
